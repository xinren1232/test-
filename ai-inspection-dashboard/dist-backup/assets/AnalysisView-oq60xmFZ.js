import{ab as Z,r as k,w as H,t as ee,n as te,j as r,e as L,o as V,k as n,aa as J,x as w,f as t,g as a,l as y,a5 as ae,a6 as le,al as pe,c as E,a7 as W,a8 as G,u as oe,M as ie,aj as me,R as ve,am as fe,$ as re,a3 as ce}from"./element-plus-CvrI1lB2.js";import{_ as K,u as se,l as _e}from"./index-BA_4wflW.js";import{cF as ne}from"./echarts-Cq7vAPzK.js";const he={class:"correlation-analyzer"},ye={class:"analyzer-header"},ge={class:"controls"},be={key:0,class:"insights-container"},xe={class:"insights-list"},we={__name:"CorrelationAnalyzer",props:{title:{type:String,default:"多参数相关性分析"},height:{type:String,default:"500px"}},setup(R){Z(b=>({"1fc59078":M.height})),se();const M=R,p=k(null),_=k(null),m=k("material"),u=k(!1),g=k([]),h=k([]),e=k([]),l=()=>{p.value&&(_.value&&_.value.dispose(),_.value=ne(p.value),C())},C=()=>{const b={title:{text:'点击"分析相关性"开始分析',left:"center",top:"center",textStyle:{color:"#909399",fontSize:16}},grid:{top:60,bottom:50,left:60,right:60}};_.value.setOption(b)},c=async()=>{u.value=!0;try{let b=await A(m.value);g.value=b.data,h.value=b.dimensions,e.value=b.insights,F()}catch(b){console.error("计算相关性时出错:",b)}finally{u.value=!1}},A=async b=>{await new Promise(o=>setTimeout(o,1e3));let d=[],D=[],v=[];switch(b){case"material":D=["耐磨性","附着力","透光率","耐化学性","硬度","强度","平整度"],d=[[1,.72,.28,.65,.34,.18,.12],[.72,1,.31,.61,.41,.23,.21],[.28,.31,1,.43,.57,.31,.08],[.65,.61,.43,1,.38,.25,.14],[.34,.41,.57,.38,1,.68,.52],[.18,.23,.31,.25,.68,1,.76],[.12,.21,.08,.14,.52,.76,1]],v=["耐磨性和附着力存在强相关性(0.72)，可能由相同的材料特性决定","硬度和强度高度相关(0.68)，这符合材料学理论预期","透光率与其他参数相关性较弱，可以作为独立质量参数考虑","平整度与强度的关联度(0.76)最高，建议联合控制这两个参数"];break;case"supplier":D=["质量评分","返修率","及时交付","价格稳定性","响应速度","技术能力","合规性"],d=[[1,-.82,.67,.47,.58,.76,.62],[-.82,1,-.51,-.32,-.48,-.65,-.53],[.67,-.51,1,.45,.72,.53,.46],[.47,-.32,.45,1,.38,.41,.34],[.58,-.48,.72,.38,1,.61,.54],[.76,-.65,.53,.41,.61,1,.69],[.62,-.53,.46,.34,.54,.69,1]],v=["质量评分与返修率呈强负相关(-0.82)，表明评分指标确实反映了质量表现","响应速度与及时交付高度相关(0.72)，表明供应商的流程效率普遍一致","技术能力与质量评分正相关(0.76)，可作为早期供应商评估的重要指标","合规性与技术能力相关度较高(0.69)，表明技术先进的供应商更注重合规"];break;case"batch":D=["不良率","抽样比例","批次规模","生产速度","工艺变更","原材料批次","环境温度"],d=[[1,-.42,.28,.53,.76,.62,.47],[-.42,1,-.15,-.22,-.38,-.27,-.18],[.28,-.15,1,.31,.25,.22,.17],[.53,-.22,.31,1,.58,.44,.36],[.76,-.38,.25,.58,1,.65,.52],[.62,-.27,.22,.44,.65,1,.41],[.47,-.18,.17,.36,.52,.41,1]],v=["工艺变更与不良率高度相关(0.76)，建议严格控制工艺变更管理","原材料批次与不良率显著相关(0.62)，需加强原材料质量控制","增加抽样比例可能降低不良率(-0.42)，但相关性不够强，表示可能存在其他关键因素","生产速度与不良率中度相关(0.53)，可能存在最佳生产速度区间"];break}return{data:d,dimensions:D,insights:v}},F=()=>{if(!_.value)return;const b=g.value,d=h.value;let D=[];for(let o=0;o<b.length;o++)for(let x=0;x<b[o].length;x++)D.push([o,x,b[o][x].toFixed(2)]);const v={tooltip:{position:"top",formatter:function(o){return`${d[o.data[0]]} 与 ${d[o.data[1]]} 的相关性: ${o.data[2]}`}},grid:{top:60,bottom:50,left:90,right:80},xAxis:{type:"category",data:d,splitArea:{show:!0},axisLabel:{interval:0,rotate:30}},yAxis:{type:"category",data:d,splitArea:{show:!0}},visualMap:{min:-1,max:1,calculable:!0,orient:"horizontal",left:"center",bottom:"0%",inRange:{color:["#3060cf","#eee","#c1403d"]},text:["高正相关","高负相关"],textStyle:{color:"#333"}},series:[{name:"相关性系数",type:"heatmap",data:D,label:{show:!0},emphasis:{itemStyle:{shadowBlur:10,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]};_.value.setOption(v)};return window.addEventListener("resize",()=>{_.value&&_.value.resize()}),H(m,()=>{g.value=[],h.value=[],e.value=[],C()}),ee(()=>{te(()=>{l()})}),(b,d)=>{const D=r("el-option"),v=r("el-select"),o=r("DataAnalysis"),x=r("el-icon"),z=r("el-button"),P=r("InfoFilled");return V(),L("div",he,[n("div",ye,[n("h3",null,w(R.title),1),n("div",ge,[t(v,{modelValue:m.value,"onUpdate:modelValue":d[0]||(d[0]=s=>m.value=s),placeholder:"选择数据集",size:"small"},{default:a(()=>[t(D,{label:"物料参数相关性",value:"material"}),t(D,{label:"供应商质量相关性",value:"supplier"}),t(D,{label:"批次参数相关性",value:"batch"})]),_:1},8,["modelValue"]),t(z,{type:"primary",size:"small",onClick:c,loading:u.value},{default:a(()=>[t(x,null,{default:a(()=>[t(o)]),_:1}),d[1]||(d[1]=y(" 分析相关性 "))]),_:1,__:[1]},8,["loading"])])]),n("div",{class:"chart-container",ref_key:"chartContainer",ref:p},null,512),e.value.length?(V(),L("div",be,[d[2]||(d[2]=n("h4",null,"相关性洞察",-1)),n("div",xe,[(V(!0),L(ae,null,le(e.value,(s,$)=>(V(),L("div",{key:$,class:"insight-item"},[t(x,null,{default:a(()=>[t(P)]),_:1}),n("span",null,w(s),1)]))),128))])])):J("",!0)])}}},ke=K(we,[["__scopeId","data-v-51f4474d"]]),Ce={class:"risk-matrix"},ze={class:"matrix-header"},$e={class:"controls"},De={key:0,class:"detail-panel"},Se={class:"detail-header"},Re={class:"action-buttons"},Me={__name:"RiskMatrix",props:{title:{type:String,default:"物料-供应商风险矩阵"},height:{type:String,default:"500px"}},setup(R){Z(v=>({"4617c2be":_.height}));const M=se(),p=_e(),_=R,m=k(null),u=k(null),g=k("all"),h=k(!1),e=k([]),l=k(null),C=()=>{m.value&&(u.value&&u.value.dispose(),u.value=ne(m.value),c())},c=async()=>{h.value=!0;try{await A(),F()}catch(v){console.error("生成风险矩阵数据时出错:",v)}finally{h.value=!1}},A=async()=>{await new Promise(z=>setTimeout(z,800));const v=M.materialBatchData,o=M.supplierData,x=[];v.forEach(z=>{const P=o.find(N=>N.name===z.supplier)||{},s=z.riskScore||Math.floor(Math.random()*100),$=Math.random()*100,I=P.qualityScore||Math.floor(Math.random()*100);let S;s>=80?S="high":s>=50?S="medium":S="low";let B=0;if(z.defectRate)if(typeof z.defectRate=="string"){const N=z.defectRate.match(/(\d+(?:\.\d+)?)%/);N&&(B=parseFloat(N[1]))}else typeof z.defectRate=="number"&&(B=z.defectRate);const Q=Math.floor(Math.random()*900)+100;x.push({materialCode:z.materialCode,materialName:z.materialName,supplier:z.supplier,risk:s,riskLevel:S,complexity:$.toFixed(1),stability:I.toFixed(1),volume:Q,defectRate:B,x:$,y:I,value:Q})}),e.value=x},F=()=>{if(!u.value)return;let v;g.value==="all"?v=e.value:v=e.value.filter(s=>s.riskLevel===g.value);const o=v.filter(s=>s.riskLevel==="high").map(s=>[s.x,s.y,s.value,s]),x=v.filter(s=>s.riskLevel==="medium").map(s=>[s.x,s.y,s.value,s]),z=v.filter(s=>s.riskLevel==="low").map(s=>[s.x,s.y,s.value,s]),P={tooltip:{trigger:"item",formatter:function(s){const $=s.data[3];return`
          <div style="font-weight: bold; margin-bottom: 5px;">${$.materialName}</div>
          <div>供应商: ${$.supplier}</div>
          <div>风险评分: ${$.risk}</div>
          <div>物料复杂度: ${$.complexity}</div>
          <div>供应商稳定性: ${$.stability}</div>
          <div>批量: ${$.volume}</div>
          <div>不良率: ${$.defectRate}%</div>
        `}},grid:{left:"10%",right:"10%",top:"10%",bottom:"10%"},xAxis:{type:"value",name:"物料复杂度",min:0,max:100,splitLine:{lineStyle:{type:"dashed"}}},yAxis:{type:"value",name:"供应商稳定性",min:0,max:100,splitLine:{lineStyle:{type:"dashed"}}},series:[{name:"高风险",type:"scatter",symbolSize:function(s){return Math.sqrt(s[2])/5},itemStyle:{color:"#F56C6C"},data:o,emphasis:{focus:"series",itemStyle:{shadowBlur:10,shadowColor:"rgba(0, 0, 0, 0.5)"}}},{name:"中风险",type:"scatter",symbolSize:function(s){return Math.sqrt(s[2])/5},itemStyle:{color:"#E6A23C"},data:x,emphasis:{focus:"series",itemStyle:{shadowBlur:10,shadowColor:"rgba(0, 0, 0, 0.5)"}}},{name:"低风险",type:"scatter",symbolSize:function(s){return Math.sqrt(s[2])/5},itemStyle:{color:"#67C23A"},data:z,emphasis:{focus:"series",itemStyle:{shadowBlur:10,shadowColor:"rgba(0, 0, 0, 0.5)"}}}],visualMap:[{show:!1,dimension:2,min:100,max:1e3,inRange:{opacity:[.2,.8]}}],graphic:[{type:"rect",z:-100,left:"10%",top:"10%",shape:{width:"30%",height:"30%"},style:{fill:"rgba(245, 108, 108, 0.1)"}},{type:"text",z:-99,left:"15%",top:"15%",style:{fill:"#F56C6C",text:"高风险区域",fontSize:14,opacity:.7}},{type:"rect",z:-100,left:"60%",top:"60%",shape:{width:"30%",height:"30%"},style:{fill:"rgba(103, 194, 58, 0.1)"}},{type:"text",z:-99,left:"65%",top:"65%",style:{fill:"#67C23A",text:"低风险区域",fontSize:14,opacity:.7}}]};u.value.setOption(P),u.value.on("click",function(s){s.seriesType==="scatter"&&(l.value=s.data[3])})},b=v=>v>=80?"danger":v>=50?"warning":"success",d=()=>{l.value&&p.push({path:"/lab-view",query:{materialCode:l.value.materialCode,supplier:l.value.supplier}})},D=()=>{l.value&&(console.log("创建风险控制计划",l.value),alert(`已为 ${l.value.materialName} (${l.value.supplier}) 创建风险控制计划`))};return window.addEventListener("resize",()=>{u.value&&u.value.resize()}),H(g,()=>{F()}),ee(()=>{te(()=>{C()})}),(v,o)=>{const x=r("el-option"),z=r("el-select"),P=r("RefreshRight"),s=r("el-icon"),$=r("el-button"),I=r("el-tooltip"),S=r("el-descriptions-item"),B=r("el-tag"),Q=r("el-descriptions");return V(),L("div",Ce,[n("div",ze,[n("h3",null,w(R.title),1),n("div",$e,[t(z,{modelValue:g.value,"onUpdate:modelValue":o[0]||(o[0]=N=>g.value=N),placeholder:"筛选视图",size:"small"},{default:a(()=>[t(x,{label:"所有物料",value:"all"}),t(x,{label:"高风险",value:"high"}),t(x,{label:"中风险",value:"medium"}),t(x,{label:"低风险",value:"low"})]),_:1},8,["modelValue"]),t(I,{content:"刷新数据",placement:"top"},{default:a(()=>[t($,{type:"primary",size:"small",onClick:c,loading:h.value,circle:""},{default:a(()=>[t(s,null,{default:a(()=>[t(P)]),_:1})]),_:1},8,["loading"])]),_:1})])]),n("div",{class:"chart-container",ref_key:"chartContainer",ref:m},null,512),o[6]||(o[6]=pe('<div class="matrix-legend" data-v-a9b71e38><div class="legend-item" data-v-a9b71e38><div class="bubble-sample high" data-v-a9b71e38></div><span data-v-a9b71e38>高风险</span></div><div class="legend-item" data-v-a9b71e38><div class="bubble-sample medium" data-v-a9b71e38></div><span data-v-a9b71e38>中风险</span></div><div class="legend-item" data-v-a9b71e38><div class="bubble-sample low" data-v-a9b71e38></div><span data-v-a9b71e38>低风险</span></div><div class="size-legend" data-v-a9b71e38><div class="size-item" data-v-a9b71e38><div class="bubble-sample-size small" data-v-a9b71e38></div><span data-v-a9b71e38>小批量</span></div><div class="size-item" data-v-a9b71e38><div class="bubble-sample-size large" data-v-a9b71e38></div><span data-v-a9b71e38>大批量</span></div></div></div>',1)),l.value?(V(),L("div",De,[n("div",Se,[o[3]||(o[3]=n("h4",null,"详细信息",-1)),t($,{type:"text",onClick:o[1]||(o[1]=N=>l.value=null)},{default:a(()=>o[2]||(o[2]=[y("关闭")])),_:1,__:[2]})]),t(Q,{column:2,border:"",size:"small"},{default:a(()=>[t(S,{label:"物料名称"},{default:a(()=>[y(w(l.value.materialName),1)]),_:1}),t(S,{label:"物料代码"},{default:a(()=>[y(w(l.value.materialCode),1)]),_:1}),t(S,{label:"供应商"},{default:a(()=>[y(w(l.value.supplier),1)]),_:1}),t(S,{label:"风险评分"},{default:a(()=>[t(B,{type:b(l.value.risk)},{default:a(()=>[y(w(l.value.risk),1)]),_:1},8,["type"])]),_:1}),t(S,{label:"物料复杂度"},{default:a(()=>[y(w(l.value.complexity),1)]),_:1}),t(S,{label:"供应商稳定性"},{default:a(()=>[y(w(l.value.stability),1)]),_:1}),t(S,{label:"批量大小"},{default:a(()=>[y(w(l.value.volume),1)]),_:1}),t(S,{label:"近期不良率"},{default:a(()=>[y(w(l.value.defectRate)+"%",1)]),_:1})]),_:1}),n("div",Re,[t($,{type:"primary",size:"small",onClick:d},{default:a(()=>o[4]||(o[4]=[y("查看详情")])),_:1,__:[4]}),t($,{type:"warning",size:"small",onClick:D},{default:a(()=>o[5]||(o[5]=[y("创建风险控制计划")])),_:1,__:[5]})])])):J("",!0)])}}},Fe=K(Me,[["__scopeId","data-v-a9b71e38"]]);function Te(R,M,p=90){const _=R.filter(l=>l.materialCode===M);_.sort((l,C)=>new Date(l.testDate)-new Date(C.testDate));const m=new Date,u=new Date;u.setDate(m.getDate()-p);const g=_.filter(l=>new Date(l.testDate)>=u),h=[],e=[];return g.forEach(l=>{h.push(l.testDate);let C=0;const c=l.defectRate;if(typeof c=="string"){const A=c.match(/(\d+(?:\.\d+)?)%/);if(A)C=parseFloat(A[1]);else{const F=c.match(/\((\d+(?:\.\d+)?)%\)/);F&&(C=parseFloat(F[1]))}}else typeof c=="number"&&(C=c);e.push(C)}),{materialCode:M,dates:h,defectRates:e,average:e.length?e.reduce((l,C)=>l+C,0)/e.length:0,prediction:Ae(e,3)}}function Ae(R,M){if(R.length<2)return[];const p=R.length,_=Array.from({length:p},(c,A)=>A);let m=0,u=0,g=0,h=0;for(let c=0;c<p;c++)m+=_[c],u+=R[c],g+=_[c]*R[c],h+=_[c]*_[c];const e=(p*g-m*u)/(p*h-m*m),l=(u-e*m)/p,C=[];for(let c=1;c<=M;c++)C.push(e*(p+c-1)+l);return C}const Ve={class:"quality-predictor"},Le={class:"predictor-header"},Pe={class:"controls"},Ee={key:0,class:"prediction-result"},Ne={class:"result-header"},Ie={class:"metrics-container"},Be={class:"metric-card"},qe={class:"metric-card"},Oe={class:"metric-card"},Qe={class:"metric-card"},Ue={class:"metric-value"},je={class:"action-buttons"},Xe={key:1,class:"no-data-message"},Ye={__name:"QualityPredictor",props:{title:{type:String,default:"质量趋势预测"},height:{type:String,default:"400px"},threshold:{type:Number,default:5}},setup(R){Z(f=>({42121003:p.height}));const M=se(),p=R,_=k(null),m=k(null),u=k(""),g=k(90),h=k(!1),e=k(null),l=k(""),C=E(()=>M.materialMasterData),c=E(()=>!e.value||!e.value.defectRates||e.value.defectRates.length===0?0:e.value.defectRates[e.value.defectRates.length-1].toFixed(1)),A=E(()=>!e.value||!e.value.prediction||e.value.prediction.length<1?0:e.value.shortTermPrediction.toFixed(1)),F=E(()=>!e.value||!e.value.prediction||e.value.prediction.length<3?0:e.value.longTermPrediction.toFixed(1)),b=E(()=>e.value?e.value.confidence||85:0),d=E(()=>{const f=parseFloat(A.value),i=parseFloat(F.value);return i>p.threshold*2?"high":f>p.threshold||i>p.threshold?"medium":"low"}),D=E(()=>{switch(d.value){case"high":return"高风险";case"medium":return"中风险";case"low":return"低风险";default:return"未知"}}),v=E(()=>d.value!=="low"),o=E(()=>{switch(d.value){case"high":return"高风险警告：不良率可能大幅上升";case"medium":return"中风险预警：不良率可能超过阈值";default:return""}}),x=E(()=>{parseFloat(A.value);const f=parseFloat(F.value);return d.value==="high"?`预测30天后不良率将达到${f}%，远高于${p.threshold}%的安全阈值，建议立即采取预防措施。`:d.value==="medium"?`预测不良率将在近期内超过${p.threshold}%的安全阈值，建议制定预防计划。`:""}),z=()=>{_.value&&(m.value&&m.value.dispose(),m.value=ne(_.value),P())},P=()=>{const f={title:{text:"请选择物料并点击分析按钮",left:"center",top:"center",textStyle:{color:"#909399",fontSize:16}},grid:{top:60,bottom:50,left:60,right:60}};m.value.setOption(f)},s=async()=>{if(!u.value){l.value="请先选择要分析的物料",e.value=null;return}h.value=!0,l.value="";try{const f=M.labTestData,i=Te(f,u.value,g.value);if(!i.dates||i.dates.length<3){l.value="数据量不足，无法进行有效预测。需要至少3个历史数据点。",e.value=null,P();return}const T=i.prediction||[];i.shortTermPrediction=T.length>0?T[0]:i.average,i.longTermPrediction=T.length>2?T[2]:i.shortTermPrediction,i.confidence=85+Math.floor(Math.random()*10),e.value=i,$(i)}catch(f){console.error("生成质量预测时出错:",f),l.value="分析过程中出错，请重试"}finally{h.value=!1}},$=f=>{if(!m.value)return;const i=f.dates||[],T=f.defectRates||[],U=f.prediction||[],j=[],X=[];i.length>0&&T.length>0&&(j.push(i[i.length-1]),X.push(T[T.length-1]));for(let q=0;q<U.length;q++)j.push(`预测${q+1}`),X.push(U[q]);const Y={title:{text:`${I(u.value)} 质量趋势预测`,left:"center"},tooltip:{trigger:"axis",axisPointer:{type:"cross"}},legend:{data:["历史不良率","预测趋势"],bottom:10},grid:{left:"3%",right:"4%",bottom:"15%",top:"15%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:[...i,...j.slice(1)],axisLabel:{interval:Math.floor(i.length/10),rotate:45}},yAxis:{type:"value",name:"不良率(%)",min:0,max:function(q){return Math.max(p.threshold*2,q.max*1.2)},axisLine:{show:!0},splitLine:{show:!0,lineStyle:{type:"dashed"}}},series:[{name:"历史不良率",type:"line",data:T,smooth:!0,symbol:"circle",symbolSize:6,itemStyle:{color:"#409EFF"},markPoint:{data:[{type:"max",name:"最大值"},{type:"min",name:"最小值"}]}},{name:"预测趋势",type:"line",data:X,smooth:!0,symbol:"circle",symbolSize:6,itemStyle:{color:"#E6A23C"},lineStyle:{type:"dashed"}}],markLine:{symbol:"none",data:[{name:"阈值线",yAxis:p.threshold,lineStyle:{color:"#F56C6C",type:"dashed"},label:{formatter:`阈值 ${p.threshold}%`,position:"end"}}]}};m.value.setOption(Y)},I=f=>{const i=M.materialMasterData.find(T=>T.materialCode===f);return i?i.materialName:f},S=f=>(f=parseFloat(f),f>p.threshold*1.5?"value-danger":f>p.threshold?"value-warning":"value-success"),B=f=>{switch(f){case"high":return"danger";case"medium":return"warning";case"low":return"success";default:return"info"}},Q=()=>{e.value&&alert(`已导出 ${I(u.value)} 质量趋势预测报告`)},N=()=>{e.value&&alert(`已为 ${I(u.value)} 创建质量预防计划`)};return window.addEventListener("resize",()=>{m.value&&m.value.resize()}),H(u,()=>{l.value="",e.value=null,P()}),H(g,()=>{e.value&&s()}),ee(()=>{te(()=>{z()})}),(f,i)=>{const T=r("el-option"),U=r("el-select"),j=r("DataAnalysis"),X=r("el-icon"),Y=r("el-button"),q=r("el-tooltip"),ue=r("el-tag"),de=r("el-alert");return V(),L("div",Ve,[n("div",Le,[n("h3",null,w(R.title),1),n("div",Pe,[t(U,{modelValue:u.value,"onUpdate:modelValue":i[0]||(i[0]=O=>u.value=O),placeholder:"选择物料",size:"small"},{default:a(()=>[(V(!0),L(ae,null,le(C.value,O=>(V(),W(T,{key:O.materialCode,label:`${O.materialName} (${O.materialCode})`,value:O.materialCode},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),t(U,{modelValue:g.value,"onUpdate:modelValue":i[1]||(i[1]=O=>g.value=O),placeholder:"时间范围",size:"small"},{default:a(()=>[t(T,{label:"最近30天",value:30}),t(T,{label:"最近90天",value:90}),t(T,{label:"最近180天",value:180})]),_:1},8,["modelValue"]),t(q,{content:"分析预测",placement:"top"},{default:a(()=>[t(Y,{type:"primary",size:"small",onClick:s,loading:h.value,circle:""},{default:a(()=>[t(X,null,{default:a(()=>[t(j)]),_:1})]),_:1},8,["loading"])]),_:1})])]),n("div",{class:"chart-container",ref_key:"chartContainer",ref:_},null,512),e.value?(V(),L("div",Ee,[n("div",Ne,[i[2]||(i[2]=n("h4",null,"预测结果",-1)),t(ue,{type:B(d.value),size:"small"},{default:a(()=>[y(w(D.value),1)]),_:1},8,["type"])]),n("div",Ie,[n("div",Be,[i[3]||(i[3]=n("div",{class:"metric-title"},"当前不良率",-1)),n("div",{class:G(["metric-value",S(c.value)])},w(c.value)+"%",3)]),n("div",qe,[i[4]||(i[4]=n("div",{class:"metric-title"},"预测不良率(10天)",-1)),n("div",{class:G(["metric-value",S(A.value)])},w(A.value)+"%",3)]),n("div",Oe,[i[5]||(i[5]=n("div",{class:"metric-title"},"预测不良率(30天)",-1)),n("div",{class:G(["metric-value",S(F.value)])},w(F.value)+"%",3)]),n("div",Qe,[i[6]||(i[6]=n("div",{class:"metric-title"},"趋势可信度",-1)),n("div",Ue,w(b.value)+"%",1)])]),v.value?(V(),W(de,{key:0,title:o.value,type:B(d.value),description:x.value,"show-icon":""},null,8,["title","type","description"])):J("",!0),n("div",je,[t(Y,{type:"primary",size:"small",onClick:Q},{default:a(()=>i[7]||(i[7]=[y("导出预测报告")])),_:1,__:[7]}),t(Y,{type:"warning",size:"small",onClick:N},{default:a(()=>i[8]||(i[8]=[y("创建质量预防计划")])),_:1,__:[8]})])])):l.value?(V(),L("div",Xe,w(l.value),1)):J("",!0)])}}},Ge=K(Ye,[["__scopeId","data-v-b4e791f2"]]),He={class:"analysis-view"},Je={class:"analysis-insights"},Ke={class:"insights-cards"},We={class:"insight-header"},Ze={class:"insight-footer"},et={class:"export-options"},tt={__name:"AnalysisView",setup(R){const M=k("correlation"),p=[{title:"强相关性发现",content:"材料硬度与耐磨性之间存在高达0.72的相关性，表明提升材料硬度可能同时改善耐磨表现，建议调整材料配方优先考虑这两个参数。",category:"参数相关",type:"info"},{title:"高风险供应商警告",content:'供应商"易湛"提供的保护膜批次近期不良率持续攀升，已达到58%的风险评分，建议立即审核其生产工艺并考虑增加抽检比例。',category:"供应商风险",type:"warning"},{title:"质量趋势预测",content:"电池盖(37301062)批次预计在未来30天内不良率将上升至7.5%，超过5%的安全阈值，建议提前介入并调整生产参数。",category:"趋势预测",type:"danger"},{title:"改进机会",content:"基于多参数分析，发现工艺温度与不良率存在明显负相关(-0.65)，建议在允许范围内适当提高工艺温度，可能降低20%的不良率。",category:"工艺优化",type:"success"}],_=h=>{switch(h){case"warning":return re;case"danger":return re;case"success":return fe;default:return ie}},m=h=>{switch(h){case"warning":return"warning";case"danger":return"danger";case"success":return"success";default:return"info"}},u=h=>{let e="";switch(h){case"excel":e="已导出Excel分析报告";break;case"pdf":e="已生成PDF分析报告";break;case"presentation":e="已生成演示文稿";break}ce({type:"success",message:e})},g=()=>{ce({type:"success",message:"分析结果已分享至相关团队"})};return(h,e)=>{const l=r("el-tab-pane"),C=r("el-tabs"),c=r("el-icon"),A=r("el-tag"),F=r("el-button"),b=r("el-card"),d=r("el-dropdown-item"),D=r("el-dropdown-menu"),v=r("el-dropdown");return V(),L("div",He,[e[8]||(e[8]=n("h2",{class:"page-title"},"高级数据分析",-1)),t(C,{modelValue:M.value,"onUpdate:modelValue":e[0]||(e[0]=o=>M.value=o),type:"border-card",class:"main-tabs"},{default:a(()=>[t(l,{label:"多参数相关性分析",name:"correlation"},{default:a(()=>[t(ke)]),_:1}),t(l,{label:"物料-供应商风险矩阵",name:"riskMatrix"},{default:a(()=>[t(Fe)]),_:1}),t(l,{label:"质量趋势预测",name:"prediction"},{default:a(()=>[t(Ge)]),_:1})]),_:1},8,["modelValue"]),n("div",Je,[n("h3",null,[t(c,null,{default:a(()=>[t(oe(ie))]),_:1}),e[1]||(e[1]=y(" 分析建议 "))]),n("div",Ke,[(V(),L(ae,null,le(p,(o,x)=>t(b,{key:x,class:"insight-card",shadow:"hover"},{default:a(()=>[n("div",We,[t(c,{class:G(`insight-icon-${o.type}`)},{default:a(()=>[(V(),W(me(_(o.type))))]),_:2},1032,["class"]),n("h4",null,w(o.title),1)]),n("p",null,w(o.content),1),n("div",Ze,[t(A,{size:"small",type:m(o.type)},{default:a(()=>[y(w(o.category),1)]),_:2},1032,["type"]),t(F,{type:"text",size:"small"},{default:a(()=>e[2]||(e[2]=[y("了解更多")])),_:1,__:[2]})])]),_:2},1024)),64))])]),n("div",et,[t(v,{onCommand:u},{dropdown:a(()=>[t(D,null,{default:a(()=>[t(d,{command:"excel"},{default:a(()=>e[4]||(e[4]=[y("导出Excel")])),_:1,__:[4]}),t(d,{command:"pdf"},{default:a(()=>e[5]||(e[5]=[y("导出PDF报告")])),_:1,__:[5]}),t(d,{command:"presentation"},{default:a(()=>e[6]||(e[6]=[y("生成演示文稿")])),_:1,__:[6]})]),_:1})]),default:a(()=>[t(F,{type:"primary"},{default:a(()=>e[3]||(e[3]=[y(" 导出分析报告"),n("i",{class:"el-icon-arrow-down el-icon--right"},null,-1)])),_:1,__:[3]})]),_:1}),t(F,{type:"success",onClick:g},{default:a(()=>[t(c,null,{default:a(()=>[t(oe(ve))]),_:1}),e[7]||(e[7]=y(" 分享分析结果 "))]),_:1,__:[7]})])])}}},nt=K(tt,[["__scopeId","data-v-6a0f5c60"]]);export{nt as default};
