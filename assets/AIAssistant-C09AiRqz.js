import{c as l,o as i,a as s,O as w,P as T,e as C,Q as q,F as _,r as m,b as M,_ as V,ai as z,S as d,V as B,W as O,t as c,X as H,n as D}from"./element-plus-DR-erZ3X.js";import{a as J}from"./index-Bo1zM2q5.js";import"./echarts-Dfqt_Pbx.js";const K={name:"AIAssistant",setup(){const u=d(""),a=d([]),y=d(!1),n=d([]),v=d(null),I=d([{name:"analyze_data",icon:"📊",displayName:"数据分析",description:"分析质量管理数据"},{name:"statistical_analysis",icon:"📈",displayName:"统计分析",description:"执行统计分析"},{name:"calculate",icon:"🧮",displayName:"数值计算",description:"执行数学计算"},{name:"format_data",icon:"📋",displayName:"数据格式化",description:"格式化数据输出"}]),g=d([{name:"create_chart",icon:"📊",displayName:"图表生成",description:"生成数据可视化图表"},{name:"trend_analysis",icon:"📈",displayName:"趋势分析",description:"分析数据趋势"},{name:"generate_report",icon:"📄",displayName:"报告生成",description:"生成质量分析报告"}]),x=d([{name:"web_search",icon:"🔍",displayName:"网络搜索",description:"搜索相关信息"},{name:"api_call",icon:"🌐",displayName:"API调用",description:"调用外部API"}]),A=d([{name:"query_inventory",icon:"📦",displayName:"库存查询",description:"查询库存信息"},{name:"query_production",icon:"🏭",displayName:"生产查询",description:"查询生产数据"},{name:"query_testing",icon:"🧪",displayName:"检测查询",description:"查询检测结果"},{name:"export_data",icon:"💾",displayName:"数据导出",description:"导出数据为各种格式"}]),e=d(["查询工厂A的库存情况","分析最近的质量趋势","生成质量报告","统计不合格品数量","查看生产线状态"]),p=async()=>{if(!u.value.trim()||y.value)return;const t={type:"user",content:u.value,timestamp:new Date};a.value.push(t);const o=u.value;u.value="",await S(),y.value=!0,n.value=[];try{await Q(o)}catch(r){console.error("AI处理错误:",r),a.value.push({type:"ai",content:"抱歉，处理您的问题时出现了错误。请稍后重试。",timestamp:new Date})}finally{y.value=!1,await S()}},k=t=>new Promise(o=>setTimeout(o,t)),h=(t,o,r,N=null)=>{n.value.push({type:t,title:o,status:r,details:N})},f=(t,o,r=null)=>{n.value[t]&&(n.value[t].status=o,r&&(n.value[t].result=r))},b=t=>{const o=t.toLowerCase();return o.includes("库存")||o.includes("inventory")?{needsData:!0,tool:"query_inventory",parameters:{data_type:"inventory"},category:"inventory"}:o.includes("生产")||o.includes("production")?{needsData:!0,tool:"query_production",parameters:{data_type:"production"},category:"production"}:o.includes("检测")||o.includes("测试")||o.includes("testing")?{needsData:!0,tool:"query_testing",parameters:{data_type:"testing"},category:"testing"}:o.includes("计算")||o.includes("算")?{needsData:!0,tool:"calculate",parameters:{expression:L(t)},category:"calculation"}:o.includes("分析")||o.includes("统计")?{needsData:!0,tool:"analyze_data",parameters:{data_type:"inventory"},category:"analysis"}:{needsData:!1,tool:"general",parameters:{},category:"general"}},L=t=>{const o=t.match(/[\d+\-*/().\s]+/);return o?o[0].trim():"1+1"},P=t=>{if(!t||!t.success)return"抱歉，查询数据时出现问题。";const o=t.data;return Array.isArray(o)?`查询到 ${o.length} 条记录。

${t.summary||"数据查询完成。"}`:typeof o=="object"?`查询结果：
${JSON.stringify(o,null,2)}`:`查询结果：${o}`},E=t=>{const o=["我是IQE AI智能助手，专门帮助您处理质量管理相关问题。","您可以询问库存、生产、检测等相关数据。","我可以帮您分析数据、生成报告、执行计算等。","如需具体帮助，请告诉我您想查询什么数据。"];return o[Math.floor(Math.random()*o.length)]},S=async()=>{await O(),v.value&&(v.value.scrollTop=v.value.scrollHeight)},Q=async t=>{h("thinking","理解问题","processing",{question:t}),await k(1e3);const o=b(t);f(0,"completed",{analysis:o}),h("analysis","分析问题类型","processing",o),await k(800),f(1,"completed"),h("tool_selection","选择合适工具","processing"),await k(600);let r="";if(o.needsData){h("data_query","查询数据","processing");const N={success:!0,data:[{id:1,name:"示例数据",value:100}],summary:"查询完成，找到1条记录"};f(3,"completed",{result:N}),r=P(N)}else r=E();f(2,"completed",{selectedTool:o.tool}),h("response","生成回答","processing"),await k(500),f(4,"completed"),a.value.push({type:"ai",content:r,timestamp:new Date})};return{inputMessage:u,messages:a,isLoading:y,currentProcess:n,chatMessages:v,dataAnalysisTools:I,visualizationTools:g,networkTools:x,qualityTools:A,quickExamples:e,sendMessage:p,sendQuickQuestion:t=>{u.value=t,p()},clearChat:()=>{a.value=[],n.value=[]},exportChat:()=>{B.success("导出功能开发中...")},formatMessage:t=>t.replace(/\n/g,"<br>"),formatTime:t=>t.toLocaleTimeString(),getStepIcon:t=>({thinking:"🤔",analysis:"🔍",tool_selection:"🛠️",data_query:"📊",response:"💬"})[t]||"⚙️",getStatusText:t=>({processing:"处理中...",completed:"完成",error:"错误"})[t]||t,formatStepResult:t=>typeof t=="object"?JSON.stringify(t,null,2):String(t)}}},R={class:"ai-assistant"},j={class:"header"},F={class:"header-actions"},U={class:"main-content"},W={class:"tools-panel"},X={class:"tool-category"},G={class:"tool-list"},Y={class:"tool-icon"},Z={class:"tool-info"},$={class:"tool-name"},ss={class:"tool-desc"},es={class:"tool-category"},ts={class:"tool-list"},os={class:"tool-icon"},as={class:"tool-info"},ns={class:"tool-name"},is={class:"tool-desc"},ls={class:"tool-category"},cs={class:"tool-list"},rs={class:"tool-icon"},ds={class:"tool-info"},us={class:"tool-name"},ps={class:"tool-desc"},_s={class:"tool-category"},ms={class:"tool-list"},ys={class:"tool-icon"},vs={class:"tool-info"},gs={class:"tool-name"},hs={class:"tool-desc"},fs={class:"chat-panel"},ks={class:"panel-header"},Ns={class:"quick-actions"},ws={class:"chat-messages",ref:"chatMessages"},Ts={class:"message-avatar"},Cs={key:0},Ms={key:1},xs={class:"message-content"},As=["innerHTML"],qs={class:"message-time"},Is={key:0,class:"message ai loading"},Ss={class:"chat-input"},Ds={class:"input-actions"},bs={class:"process-panel"},Ls={class:"process-content"},Ps={key:0,class:"empty-state"},Es={class:"step-header"},Qs={class:"step-icon"},Vs={class:"step-title"},zs={class:"step-status"},Bs={key:0,class:"step-details"},Os={key:1,class:"step-result"},Hs={class:"result-content"};function Js(u,a,y,n,v,I){const g=q("el-button"),x=q("el-tag"),A=q("el-input");return i(),l("div",R,[s("div",j,[a[3]||(a[3]=s("h1",null,"🤖 IQE AI 智能助手",-1)),s("div",F,[w(g,{onClick:n.clearChat,type:"primary",plain:""},{default:T(()=>a[1]||(a[1]=[C("清空对话")])),_:1,__:[1]},8,["onClick"]),w(g,{onClick:n.exportChat,type:"success",plain:""},{default:T(()=>a[2]||(a[2]=[C("导出对话")])),_:1,__:[2]},8,["onClick"])])]),s("div",U,[s("div",W,[a[8]||(a[8]=s("div",{class:"panel-header"},[s("h3",null,"🛠️ 可用工具")],-1)),s("div",X,[a[4]||(a[4]=s("h4",null,"📊 数据分析工具",-1)),s("div",G,[(i(!0),l(_,null,m(n.dataAnalysisTools,e=>(i(),l("div",{class:"tool-item",key:e.name},[s("div",Y,c(e.icon),1),s("div",Z,[s("div",$,c(e.displayName),1),s("div",ss,c(e.description),1)])]))),128))])]),s("div",es,[a[5]||(a[5]=s("h4",null,"📈 可视化工具",-1)),s("div",ts,[(i(!0),l(_,null,m(n.visualizationTools,e=>(i(),l("div",{class:"tool-item",key:e.name},[s("div",os,c(e.icon),1),s("div",as,[s("div",ns,c(e.displayName),1),s("div",is,c(e.description),1)])]))),128))])]),s("div",ls,[a[6]||(a[6]=s("h4",null,"🌐 联网工具",-1)),s("div",cs,[(i(!0),l(_,null,m(n.networkTools,e=>(i(),l("div",{class:"tool-item",key:e.name},[s("div",rs,c(e.icon),1),s("div",ds,[s("div",us,c(e.displayName),1),s("div",ps,c(e.description),1)])]))),128))])]),s("div",_s,[a[7]||(a[7]=s("h4",null,"🎯 质量管理",-1)),s("div",ms,[(i(!0),l(_,null,m(n.qualityTools,e=>(i(),l("div",{class:"tool-item",key:e.name},[s("div",ys,c(e.icon),1),s("div",vs,[s("div",gs,c(e.displayName),1),s("div",hs,c(e.description),1)])]))),128))])])]),s("div",fs,[s("div",ks,[a[9]||(a[9]=s("h3",null,"💬 智能问答",-1)),s("div",Ns,[(i(!0),l(_,null,m(n.quickExamples,e=>(i(),H(x,{key:e,onClick:p=>n.sendQuickQuestion(e),class:"quick-tag"},{default:T(()=>[C(c(e),1)]),_:2},1032,["onClick"]))),128))])]),s("div",ws,[(i(!0),l(_,null,m(n.messages,(e,p)=>(i(),l("div",{key:p,class:D(["message",e.type])},[s("div",Ts,[e.type==="user"?(i(),l("span",Cs,"👤")):(i(),l("span",Ms,"🤖"))]),s("div",xs,[s("div",{class:"message-text",innerHTML:n.formatMessage(e.content)},null,8,As),s("div",qs,c(n.formatTime(e.timestamp)),1)])],2))),128)),n.isLoading?(i(),l("div",Is,a[10]||(a[10]=[s("div",{class:"message-avatar"},"🤖",-1),s("div",{class:"message-content"},[s("div",{class:"typing-indicator"},[s("span"),s("span"),s("span")])],-1)]))):M("",!0)],512),s("div",Ss,[w(A,{modelValue:n.inputMessage,"onUpdate:modelValue":a[0]||(a[0]=e=>n.inputMessage=e),type:"textarea",rows:3,placeholder:"请输入您的问题...",onKeydown:V(z(n.sendMessage,["ctrl"]),["enter"]),disabled:n.isLoading},null,8,["modelValue","onKeydown","disabled"]),s("div",Ds,[w(g,{onClick:n.sendMessage,type:"primary",loading:n.isLoading},{default:T(()=>a[11]||(a[11]=[C(" 发送 (Ctrl+Enter) ")])),_:1,__:[11]},8,["onClick","loading"])])])]),s("div",bs,[a[14]||(a[14]=s("div",{class:"panel-header"},[s("h3",null,"🧠 AI思考过程")],-1)),s("div",Ls,[n.currentProcess.length===0?(i(),l("div",Ps,a[12]||(a[12]=[s("div",{class:"empty-icon"},"🤔",-1),s("div",{class:"empty-text"},"AI正在等待您的问题...",-1)]))):M("",!0),(i(!0),l(_,null,m(n.currentProcess,(e,p)=>(i(),l("div",{key:p,class:D(["process-step",e.status])},[s("div",Es,[s("div",Qs,c(n.getStepIcon(e.type)),1),s("div",Vs,c(e.title),1),s("div",zs,c(n.getStatusText(e.status)),1)]),e.details?(i(),l("div",Bs,[s("pre",null,c(JSON.stringify(e.details,null,2)),1)])):M("",!0),e.result?(i(),l("div",Os,[a[13]||(a[13]=s("div",{class:"result-label"},"执行结果:",-1)),s("div",Hs,c(n.formatStepResult(e.result)),1)])):M("",!0)],2))),128))])])])])}const Fs=J(K,[["render",Js],["__scopeId","data-v-e4a8a12b"]]);export{Fs as default};
