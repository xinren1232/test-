import{av as i,aw as a}from"./index-Bo1zM2q5.js";import"./element-plus-DR-erZ3X.js";import"./echarts-Dfqt_Pbx.js";class c{constructor(){this.apiClient=i}async getAllRules(){try{return await this.apiClient.get(a.RULES.LIST)}catch(t){throw console.error("获取规则失败:",t),t}}async getRuleCategories(){try{return await this.apiClient.get(a.RULES.CATEGORIES)}catch(t){throw console.error("获取规则分类失败:",t),t}}async getRuleStats(){try{return await this.apiClient.get(a.RULES.STATS)}catch(t){throw console.error("获取规则统计失败:",t),t}}async testRule(t){try{return await this.apiClient.post(a.RULES.TEST(t))}catch(e){throw console.error(`测试规则 ${t} 失败:`,e),e}}async testAllRules(){try{return await this.apiClient.post(a.RULES.TEST_ALL)}catch(t){throw console.error("批量测试规则失败:",t),t}}async getDataStatus(){try{return await this.apiClient.get(a.DATA.STATUS)}catch(t){throw console.error("获取数据状态失败:",t),t}}formatRulesForDisplay(t){return t.map(e=>({id:e.id,name:e.intent_name,description:e.description,priority:e.priority,status:e.status,example:e.example_query,createdAt:new Date(e.created_at).toLocaleDateString("zh-CN"),updatedAt:new Date(e.updated_at).toLocaleDateString("zh-CN"),category:this.getCategoryByPriority(e.priority)}))}getCategoryByPriority(t){switch(parseInt(t)){case 10:return"基础查询规则";case 20:return"进阶分析规则";case 30:return"高级统计规则";case 40:return"专项分析规则";case 50:return"趋势对比规则";case 9:return"中级规则";case 8:return"中级规则";case 7:return"高级规则";case 6:return"专项规则";case 5:return"排行规则";case 4:return"复杂规则";case 3:return"追溯规则";default:return"未分类"}}getCategoryColor(t){return{基础查询规则:"#67C23A",进阶分析规则:"#409EFF",高级统计规则:"#E6A23C",专项分析规则:"#F56C6C",趋势对比规则:"#909399",中级规则:"#95D475",高级规则:"#FFA940",专项规则:"#FF7875",排行规则:"#40A9FF",复杂规则:"#B37FEB",追溯规则:"#36CFC9",未分类:"#C0C4CC"}[t]||"#C0C4CC"}getStatusColor(t){return t==="active"?"success":"info"}getStatusText(t){return t==="active"?"活跃":"非活跃"}exportRules(t){const e={exportTime:new Date().toISOString(),totalRules:t.length,rules:t.map(n=>({name:n.intent_name,description:n.description,priority:n.priority,status:n.status,example:n.example_query,category:this.getCategoryByPriority(n.priority)}))},r=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),s=URL.createObjectURL(r),o=document.createElement("a");o.href=s,o.download=`iqe-rules-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(s)}searchRules(t,e){if(!e)return t;const r=e.toLowerCase();return t.filter(s=>{var o;return s.intent_name.toLowerCase().includes(r)||s.description.toLowerCase().includes(r)||((o=s.example_query)==null?void 0:o.toLowerCase().includes(r))})}filterRulesByCategory(t,e){return!e||e==="全部"?t:t.filter(r=>this.getCategoryByPriority(r.priority)===e)}filterRulesByStatus(t,e){return!e||e==="全部"?t:t.filter(r=>r.status===e)}}const C=new c;export{C as default};
