import{S as p,aj as K,T as P,c as n,o,a as e,O as h,Q as A,P as S,e as C,F as I,r as k,b as D,_ as H,ai as W,t as i,n as E,X,V as x,W as G}from"./element-plus-DR-erZ3X.js";import{a as Y}from"./aiService-CKXedvtd.js";import{a as Z}from"./index-Bo1zM2q5.js";import"./echarts-Dfqt_Pbx.js";const ee={class:"ai-assistant-container"},te={class:"top-header"},se={class:"header-controls"},ae={class:"three-column-layout"},oe={class:"left-column"},ne={class:"tools-section"},ie=["onClick"],le={class:"tool-icon"},ce={class:"tool-details"},re={class:"tool-name"},ue={class:"tool-desc"},de={class:"middle-column"},pe={class:"column-header"},me={class:"quick-examples"},ve={class:"message-avatar"},_e={key:0},ge={key:1},ye={class:"message-body"},he={class:"message-text"},Ie={class:"message-timestamp"},ke={key:0,class:"chat-message ai loading-message"},fe={class:"input-area"},we={class:"input-controls"},Ae={class:"right-column"},Se={class:"thinking-area"},Ce={key:0,class:"empty-thinking"},De={class:"step-header"},xe={class:"step-icon"},be={class:"step-title"},Te={class:"step-status"},Ee={key:0,class:"step-result"},Oe={class:"result-content"},Ve={__name:"AIAssistantFinal",setup(Me){const d=p(""),v=p([{type:"ai",content:"æ‚¨å¥½ï¼æˆ‘æ˜¯IQE AIæ™ºèƒ½åŠ©æ‰‹ã€‚æˆ‘å·²æŽ¥å…¥DeepSeekå¤§è¯­è¨€æ¨¡åž‹ï¼Œå¯ä»¥ä¸ºæ‚¨æä¾›ä¸“ä¸šçš„è´¨é‡ç®¡ç†é—®ç­”æœåŠ¡ã€‚",timestamp:new Date}]),m=p(!1),g=p(!0),l=p([]),f=p(null),w=p(""),O=p("info"),M=p(["æŸ¥è¯¢å·¥åŽ‚Açš„åº“å­˜æƒ…å†µ","åˆ†æžæœ€è¿‘çš„è´¨é‡è¶‹åŠ¿","ç”Ÿæˆè´¨é‡æŠ¥å‘Š","ç»Ÿè®¡ä¸åˆæ ¼å“æ•°é‡","æŸ¥çœ‹ç”Ÿäº§çº¿çŠ¶æ€","æ£€æµ‹å¼‚å¸¸ç‰©æ–™æ‰¹æ¬¡"]),$=K([{name:"æ•°æ®åˆ†æžå·¥å…·",icon:"ðŸ“Š",tools:[{name:"æ•°æ®åˆ†æž",icon:"ðŸ“Š",description:"åˆ†æžè´¨é‡ç®¡ç†æ•°æ®"},{name:"ç»Ÿè®¡åˆ†æž",icon:"ðŸ“ˆ",description:"æ‰§è¡Œç»Ÿè®¡åˆ†æž"},{name:"æ•°å€¼è®¡ç®—",icon:"ðŸ§®",description:"æ‰§è¡Œæ•°å­¦è®¡ç®—"}]},{name:"å¯è§†åŒ–å·¥å…·",icon:"ðŸ“ˆ",tools:[{name:"å›¾è¡¨ç”Ÿæˆ",icon:"ðŸ“Š",description:"ç”Ÿæˆæ•°æ®å¯è§†åŒ–å›¾è¡¨"},{name:"æŠ¥å‘Šç”Ÿæˆ",icon:"ðŸ“„",description:"ç”Ÿæˆè´¨é‡åˆ†æžæŠ¥å‘Š"}]},{name:"è”ç½‘å·¥å…·",icon:"ðŸŒ",tools:[{name:"ç½‘ç»œæœç´¢",icon:"ðŸ”",description:"æœç´¢ç›¸å…³ä¿¡æ¯"}]},{name:"è´¨é‡ç®¡ç†",icon:"ðŸŽ¯",tools:[{name:"åº“å­˜æŸ¥è¯¢",icon:"ðŸ“¦",description:"æŸ¥è¯¢åº“å­˜ä¿¡æ¯"},{name:"ç”Ÿäº§æŸ¥è¯¢",icon:"ðŸ­",description:"æŸ¥è¯¢ç”Ÿäº§æ•°æ®"},{name:"æ£€æµ‹æŸ¥è¯¢",icon:"ðŸ§ª",description:"æŸ¥è¯¢æ£€æµ‹ç»“æžœ"}]}]),Q=s=>s?new Date(s).toLocaleTimeString():"",B=s=>({thinking:"ðŸ¤”",analysis:"ðŸ”",data_query:"ðŸ“Š",ai_call:"ðŸ¤–",response:"ðŸ’¬"})[s]||"âš™ï¸",N=s=>({processing:"å¤„ç†ä¸­...",completed:"å®Œæˆ",error:"é”™è¯¯"})[s]||s,_=(s,t="info")=>{w.value=s,O.value=t,setTimeout(()=>{w.value=""},3e3)},V=()=>{G(()=>{f.value&&(f.value.scrollTop=f.value.scrollHeight)})},L=s=>{const t=`è¯·ä½¿ç”¨${s.name}å·¥å…·å¸®æˆ‘${s.description}`;d.value=t,x.success(`å·²é€‰æ‹©å·¥å…·ï¼š${s.name}`)},R=s=>{d.value=s,b()},U=()=>{const s=g.value?"AIå¢žå¼ºæ¨¡å¼":"åŸºç¡€æ¨¡å¼";x.info(`å·²åˆ‡æ¢åˆ°${s}`),_(`å·²åˆ‡æ¢åˆ°${s}`,"success")},j=()=>{v.value=[{type:"ai",content:"å¯¹è¯å·²æ¸…ç©ºã€‚æ‚¨å¥½ï¼æˆ‘æ˜¯IQE AIæ™ºèƒ½åŠ©æ‰‹ï¼Œå·²æŽ¥å…¥DeepSeekå¤§è¯­è¨€æ¨¡åž‹ã€‚",timestamp:new Date}],l.value=[],x.success("å¯¹è¯å·²æ¸…ç©º")},q=()=>{const s={timestamp:new Date().toISOString(),messages:v.value,aiMode:g.value?"AIå¢žå¼ºæ¨¡å¼":"åŸºç¡€æ¨¡å¼"},t=JSON.stringify(s,null,2),c=new Blob([t],{type:"application/json"}),r=URL.createObjectURL(c),y=document.createElement("a");y.href=r,y.download=`IQE-AIå¯¹è¯è®°å½•-${new Date().toISOString().slice(0,10)}.json`,y.click(),URL.revokeObjectURL(r),x.success("å¯¹è¯è®°å½•å·²å¯¼å‡º")},b=async()=>{if(!d.value.trim()||m.value)return;const s={type:"user",content:d.value,timestamp:new Date};v.value.push(s);const t=d.value;d.value="",V();try{await F(t)}catch(c){console.error("AIå¤„ç†é”™è¯¯:",c),v.value.push({type:"ai",content:"æŠ±æ­‰ï¼Œå¤„ç†æ‚¨çš„é—®é¢˜æ—¶å‡ºçŽ°äº†é”™è¯¯ã€‚è¯·ç¨åŽé‡è¯•ã€‚",timestamp:new Date}),_("å¤„ç†å¤±è´¥ï¼Œè¯·ç¨åŽé‡è¯•","error")}V()},F=async s=>{m.value=!0,l.value=[];try{l.value.push({type:"thinking",title:"ç†è§£é—®é¢˜",status:"processing"}),await T(500),l.value[0].status="completed",l.value.push({type:"data_query",title:"èŽ·å–ä¸šåŠ¡æ•°æ®",status:"processing"});const t=await J();await T(400),l.value[1].status="completed",l.value.push({type:"ai_call",title:"è°ƒç”¨AIå¤§æ¨¡åž‹",status:"processing"});let c;if(g.value)try{const r=await Y.queryAI(s,t);c=r.response||r.answer||r.content||"æŠ±æ­‰ï¼ŒAIæœåŠ¡è¿”å›žäº†ç©ºå“åº”ã€‚",_("AIå“åº”æˆåŠŸ","success")}catch(r){console.error("AIè°ƒç”¨å¤±è´¥:",r),c=`æŠ±æ­‰ï¼ŒAIæœåŠ¡æš‚æ—¶ä¸å¯ç”¨ã€‚åŸºäºŽæ‚¨çš„é—®é¢˜"${s}"ï¼Œæˆ‘ä¸ºæ‚¨æä¾›åŸºç¡€åˆ†æž...`,_("AIæœåŠ¡ä¸å¯ç”¨ï¼Œå·²åˆ‡æ¢åˆ°åŸºç¡€æ¨¡å¼","error")}else c=`åŸºç¡€æ¨¡å¼å›žå¤ï¼šæˆ‘æ”¶åˆ°äº†æ‚¨çš„é—®é¢˜"${s}"ã€‚è¿™æ˜¯ä¸€ä¸ªå…³äºŽè´¨é‡ç®¡ç†çš„é—®é¢˜ï¼Œæˆ‘æ­£åœ¨ä¸ºæ‚¨åˆ†æžç›¸å…³æ•°æ®...`;l.value[2].status="completed",l.value.push({type:"response",title:"ç”Ÿæˆå›žç­”",status:"processing"}),await T(200),l.value[3].status="completed",v.value.push({type:"ai",content:c,timestamp:new Date})}catch(t){throw console.error("å¤„ç†AIå“åº”æ—¶å‡ºé”™:",t),_("å¤„ç†å¤±è´¥","error"),t}finally{m.value=!1}},J=async()=>{try{const s=JSON.parse(localStorage.getItem("inventoryData")||"[]"),t=JSON.parse(localStorage.getItem("productionData")||"[]"),c=JSON.parse(localStorage.getItem("testData")||"[]");return{inventoryCount:s.length,productionCount:t.length,testCount:c.length,factoryCount:3,timestamp:new Date().toISOString()}}catch(s){return console.error("èŽ·å–ä¸šåŠ¡æ•°æ®å¤±è´¥:",s),{inventoryCount:132,productionCount:1056,testCount:396,factoryCount:3,timestamp:new Date().toISOString()}}},T=s=>new Promise(t=>setTimeout(t,s));return P(()=>{console.log("ðŸ¤– IQE AIæ™ºèƒ½åŠ©æ‰‹å·²åŠ è½½"),_("AIæ™ºèƒ½åŠ©æ‰‹å·²å°±ç»ªï¼ŒDeepSeekæ¨¡åž‹å·²è¿žæŽ¥","success")}),(s,t)=>{const c=A("el-switch"),r=A("el-button"),y=A("el-tag"),z=A("el-input");return o(),n("div",ee,[e("div",te,[t[4]||(t[4]=e("h1",null,"ðŸ¤– IQE AI æ™ºèƒ½åŠ©æ‰‹",-1)),e("div",se,[h(c,{modelValue:g.value,"onUpdate:modelValue":t[0]||(t[0]=a=>g.value=a),onChange:U,"active-text":"AIå¢žå¼ºæ¨¡å¼","inactive-text":"åŸºç¡€æ¨¡å¼",size:"large"},null,8,["modelValue"]),h(r,{onClick:j,type:"primary",plain:""},{default:S(()=>t[2]||(t[2]=[C("æ¸…ç©ºå¯¹è¯")])),_:1,__:[2]}),h(r,{onClick:q,type:"success",plain:""},{default:S(()=>t[3]||(t[3]=[C("å¯¼å‡ºå¯¹è¯")])),_:1,__:[3]})])]),e("div",ae,[e("div",oe,[t[5]||(t[5]=e("div",{class:"column-header"},[e("h3",null,"ðŸ› ï¸ å¯ç”¨å·¥å…·")],-1)),e("div",ne,[(o(!0),n(I,null,k($,a=>(o(),n("div",{class:"tool-category",key:a.name},[e("h4",null,i(a.icon)+" "+i(a.name),1),(o(!0),n(I,null,k(a.tools,u=>(o(),n("div",{class:"tool-item",key:u.name,onClick:$e=>L(u)},[e("span",le,i(u.icon),1),e("div",ce,[e("div",re,i(u.name),1),e("div",ue,i(u.description),1)])],8,ie))),128))]))),128))])]),e("div",de,[e("div",pe,[t[6]||(t[6]=e("h3",null,"ðŸ’¬ æ™ºèƒ½é—®ç­”",-1)),e("div",me,[(o(!0),n(I,null,k(M.value,a=>(o(),X(y,{key:a,onClick:u=>R(a),class:"example-tag",type:"info",effect:"plain"},{default:S(()=>[C(i(a),1)]),_:2},1032,["onClick"]))),128))])]),e("div",{class:"messages-area",ref_key:"messagesArea",ref:f},[(o(!0),n(I,null,k(v.value,(a,u)=>(o(),n("div",{key:u,class:E(["chat-message",a.type])},[e("div",ve,[a.type==="user"?(o(),n("span",_e,"ðŸ‘¤")):(o(),n("span",ge,"ðŸ¤–"))]),e("div",ye,[e("div",he,i(a.content),1),e("div",Ie,i(Q(a.timestamp)),1)])],2))),128)),m.value?(o(),n("div",ke,t[7]||(t[7]=[e("div",{class:"message-avatar"},"ðŸ¤–",-1),e("div",{class:"message-body"},[e("div",{class:"typing-animation"},[e("span"),e("span"),e("span")]),e("div",{class:"loading-text"},"AIæ­£åœ¨æ€è€ƒä¸­...")],-1)]))):D("",!0)],512),e("div",fe,[h(z,{modelValue:d.value,"onUpdate:modelValue":t[1]||(t[1]=a=>d.value=a),type:"textarea",rows:3,placeholder:"è¯·è¾“å…¥æ‚¨çš„é—®é¢˜...",onKeydown:H(W(b,["ctrl"]),["enter"]),disabled:m.value,resize:"none"},null,8,["modelValue","onKeydown","disabled"]),e("div",we,[h(r,{onClick:b,type:"primary",loading:m.value,disabled:!d.value.trim()},{default:S(()=>[C(i(m.value?"å‘é€ä¸­...":"å‘é€ (Ctrl+Enter)"),1)]),_:1},8,["loading","disabled"])]),w.value?(o(),n("div",{key:0,class:E(["status-message",O.value])},i(w.value),3)):D("",!0)])]),e("div",Ae,[t[9]||(t[9]=e("div",{class:"column-header"},[e("h3",null,"ðŸ§  AIæ€è€ƒè¿‡ç¨‹")],-1)),e("div",Se,[l.value.length===0?(o(),n("div",Ce,t[8]||(t[8]=[e("div",{class:"empty-icon"},"ðŸ¤”",-1),e("div",{class:"empty-text"},"AIæ­£åœ¨ç­‰å¾…æ‚¨çš„é—®é¢˜...",-1)]))):D("",!0),(o(!0),n(I,null,k(l.value,(a,u)=>(o(),n("div",{key:u,class:E(["thinking-step",a.status])},[e("div",De,[e("span",xe,i(B(a.type)),1),e("span",be,i(a.title),1),e("span",Te,i(N(a.status)),1)]),a.result?(o(),n("div",Ee,[e("div",Oe,i(a.result),1)])):D("",!0)],2))),128))])])])])}}},Re=Z(Ve,[["__scopeId","data-v-12e1f8b9"]]);export{Re as default};
