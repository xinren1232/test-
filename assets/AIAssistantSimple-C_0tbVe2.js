import{c as a,o as d,a as s,t as o,e as v,b as u,F as p,r as m,M as h,Z as k,_ as y,ai as I,n as g}from"./element-plus-DR-erZ3X.js";import{a as A}from"./index-Bo1zM2q5.js";import"./echarts-Dfqt_Pbx.js";const f={name:"AIAssistantSimple",data(){return{aiEnabled:!0,loading:!1,userInput:"",messages:[{type:"ai",content:"您好！我是IQE AI智能助手。我已接入DeepSeek大语言模型，可以为您提供专业的质量管理问答服务。",timestamp:new Date}],thinkingSteps:[]}},methods:{goBack(){this.$router.push("/")},toggleAI(){this.aiEnabled=!this.aiEnabled,this.$message.info(`已切换到${this.aiEnabled?"AI增强模式":"基础模式"}`)},clearChat(){this.messages=[{type:"ai",content:"对话已清空。您好！我是IQE AI智能助手，已接入DeepSeek大语言模型。",timestamp:new Date}],this.thinkingSteps=[]},selectTool(i){this.userInput=`请使用${i}工具帮我分析数据`,this.$message.success(`已选择工具：${i}`)},askQuick(i){this.userInput=i,this.sendMessage()},async sendMessage(){if(!this.userInput.trim()||this.loading)return;const i={type:"user",content:this.userInput,timestamp:new Date};this.messages.push(i);const t=this.userInput;this.userInput="",this.scrollToBottom();try{await this.processAI(t)}catch(r){console.error("AI处理错误:",r),this.messages.push({type:"ai",content:"抱歉，处理您的问题时出现了错误。请稍后重试。",timestamp:new Date})}this.scrollToBottom()},async processAI(i){this.loading=!0,this.thinkingSteps=[];try{this.thinkingSteps.push({type:"thinking",title:"理解问题",status:"processing"}),await this.delay(500),this.thinkingSteps[0].status="completed",this.thinkingSteps.push({type:"data_query",title:"获取业务数据",status:"processing"}),await this.delay(400),this.thinkingSteps[1].status="completed",this.thinkingSteps.push({type:"ai_call",title:"调用AI大模型",status:"processing"});let t;if(this.aiEnabled)try{t=await this.callAI(i)}catch{t=`抱歉，AI服务暂时不可用。基于您的问题"${i}"，我为您提供基础分析...`}else t=`基础模式回复：我收到了您的问题"${i}"。这是一个关于质量管理的问题，我正在为您分析相关数据...`;this.thinkingSteps[2].status="completed",this.thinkingSteps.push({type:"response",title:"生成回答",status:"processing"}),await this.delay(200),this.thinkingSteps[3].status="completed",this.messages.push({type:"ai",content:t,timestamp:new Date})}finally{this.loading=!1}},async callAI(i){const t=await fetch("https://api.deepseek.com/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer sk-cab797574abf4288bcfaca253191565d"},body:JSON.stringify({model:"deepseek-chat",messages:[{role:"system",content:"你是IQE质量管理系统的AI智能助手，专门负责质量管理数据分析和问答。请基于用户问题提供专业、准确、有用的回答。"},{role:"user",content:i}],temperature:.7,max_tokens:2e3})});if(!t.ok)throw new Error(`AI API错误: ${t.status}`);return(await t.json()).choices[0].message.content},delay(i){return new Promise(t=>setTimeout(t,i))},formatTime(i){return new Date(i).toLocaleTimeString()},getStepIcon(i){return{thinking:"🤔",data_query:"📊",ai_call:"🤖",response:"💬"}[i]||"⚙️"},getStatusText(i){return{processing:"处理中...",completed:"完成"}[i]||i},scrollToBottom(){this.$nextTick(()=>{this.$refs.chatArea&&(this.$refs.chatArea.scrollTop=this.$refs.chatArea.scrollHeight)})}},mounted(){console.log("🤖 IQE AI智能助手已加载")}},S={id:"ai-assistant-overlay"},b={class:"ai-container"},T={class:"ai-header"},w={class:"ai-controls"},C={class:"ai-body"},x={class:"ai-left"},E={class:"tool-section"},_={class:"tool-group"},B={class:"tool-group"},D={class:"tool-group"},M={class:"ai-center"},Q={class:"panel-title"},V={class:"quick-tags"},N={class:"chat-area",ref:"chatArea"},P={class:"avatar"},j={class:"content"},q={class:"text"},z={class:"time"},F={key:0,class:"message ai"},K={class:"input-area"},L=["disabled"],O=["disabled"],H={class:"ai-right"},J={class:"thinking-area"},U={key:0,class:"empty"},Z={class:"step-header"},G={class:"step-icon"},R={class:"step-title"},W={class:"step-status"};function X(i,t,r,Y,l,n){return d(),a("div",S,[s("div",b,[s("div",T,[t[15]||(t[15]=s("h1",null,"🤖 IQE AI 智能助手",-1)),s("div",w,[s("button",{class:"ai-btn primary",onClick:t[0]||(t[0]=(...e)=>n.toggleAI&&n.toggleAI(...e))},o(l.aiEnabled?"AI增强模式":"基础模式"),1),s("button",{class:"ai-btn",onClick:t[1]||(t[1]=(...e)=>n.clearChat&&n.clearChat(...e))},"清空对话"),s("button",{class:"ai-btn secondary",onClick:t[2]||(t[2]=(...e)=>n.goBack&&n.goBack(...e))},"返回系统")])]),s("div",C,[s("div",x,[t[25]||(t[25]=s("div",{class:"panel-title"},"🛠️ 可用工具",-1)),s("div",E,[s("div",_,[t[18]||(t[18]=s("h4",null,"📊 数据分析工具",-1)),s("div",{class:"tool-item",onClick:t[3]||(t[3]=e=>n.selectTool("数据分析"))},t[16]||(t[16]=[s("span",null,"📊",-1),s("div",null,[s("div",{class:"tool-name"},"数据分析"),s("div",{class:"tool-desc"},"分析质量管理数据")],-1)])),s("div",{class:"tool-item",onClick:t[4]||(t[4]=e=>n.selectTool("统计分析"))},t[17]||(t[17]=[s("span",null,"📈",-1),s("div",null,[s("div",{class:"tool-name"},"统计分析"),s("div",{class:"tool-desc"},"执行统计分析")],-1)]))]),s("div",B,[t[21]||(t[21]=s("h4",null,"📈 可视化工具",-1)),s("div",{class:"tool-item",onClick:t[5]||(t[5]=e=>n.selectTool("图表生成"))},t[19]||(t[19]=[s("span",null,"📊",-1),s("div",null,[s("div",{class:"tool-name"},"图表生成"),s("div",{class:"tool-desc"},"生成数据可视化图表")],-1)])),s("div",{class:"tool-item",onClick:t[6]||(t[6]=e=>n.selectTool("报告生成"))},t[20]||(t[20]=[s("span",null,"📄",-1),s("div",null,[s("div",{class:"tool-name"},"报告生成"),s("div",{class:"tool-desc"},"生成质量分析报告")],-1)]))]),s("div",D,[t[24]||(t[24]=s("h4",null,"🎯 质量管理",-1)),s("div",{class:"tool-item",onClick:t[7]||(t[7]=e=>n.selectTool("库存查询"))},t[22]||(t[22]=[s("span",null,"📦",-1),s("div",null,[s("div",{class:"tool-name"},"库存查询"),s("div",{class:"tool-desc"},"查询库存信息")],-1)])),s("div",{class:"tool-item",onClick:t[8]||(t[8]=e=>n.selectTool("生产查询"))},t[23]||(t[23]=[s("span",null,"🏭",-1),s("div",null,[s("div",{class:"tool-name"},"生产查询"),s("div",{class:"tool-desc"},"查询生产数据")],-1)]))])])]),s("div",M,[s("div",Q,[t[26]||(t[26]=v(" 💬 智能问答 ")),s("div",V,[s("span",{class:"tag",onClick:t[9]||(t[9]=e=>n.askQuick("查询工厂A的库存情况"))},"查询工厂A的库存情况"),s("span",{class:"tag",onClick:t[10]||(t[10]=e=>n.askQuick("分析最近的质量趋势"))},"分析最近的质量趋势"),s("span",{class:"tag",onClick:t[11]||(t[11]=e=>n.askQuick("生成质量报告"))},"生成质量报告")])]),s("div",N,[(d(!0),a(p,null,m(l.messages,(e,c)=>(d(),a("div",{key:c,class:g(["message",e.type])},[s("div",P,o(e.type==="user"?"👤":"🤖"),1),s("div",j,[s("div",q,o(e.content),1),s("div",z,o(n.formatTime(e.timestamp)),1)])],2))),128)),l.loading?(d(),a("div",F,t[27]||(t[27]=[s("div",{class:"avatar"},"🤖",-1),s("div",{class:"content"},[s("div",{class:"loading-dots"},[s("span"),s("span"),s("span")]),s("div",{class:"loading-text"},"AI正在思考中...")],-1)]))):u("",!0)],512),s("div",K,[h(s("textarea",{"onUpdate:modelValue":t[12]||(t[12]=e=>l.userInput=e),placeholder:"请输入您的问题...",onKeydown:t[13]||(t[13]=y(I((...e)=>n.sendMessage&&n.sendMessage(...e),["ctrl"]),["enter"])),disabled:l.loading},null,40,L),[[k,l.userInput]]),s("button",{class:"send-btn",onClick:t[14]||(t[14]=(...e)=>n.sendMessage&&n.sendMessage(...e)),disabled:!l.userInput.trim()||l.loading},o(l.loading?"发送中...":"发送"),9,O)])]),s("div",H,[t[29]||(t[29]=s("div",{class:"panel-title"},"🧠 AI思考过程",-1)),s("div",J,[l.thinkingSteps.length===0?(d(),a("div",U,t[28]||(t[28]=[s("div",{class:"empty-icon"},"🤔",-1),s("div",{class:"empty-text"},"AI正在等待您的问题...",-1)]))):u("",!0),(d(!0),a(p,null,m(l.thinkingSteps,(e,c)=>(d(),a("div",{key:c,class:g(["step",e.status])},[s("div",Z,[s("span",G,o(n.getStepIcon(e.type)),1),s("span",R,o(e.title),1),s("span",W,o(n.getStatusText(e.status)),1)])],2))),128))])])])])])}const es=A(f,[["render",X]]);export{es as default};
