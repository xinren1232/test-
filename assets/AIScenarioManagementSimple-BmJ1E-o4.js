import{a as ie}from"./index-Bo1zM2q5.js";import{S as w,$ as L,T as re,c as C,o as b,a as s,O as c,e as v,t as f,P as m,Q as x,F as q,r as $,b as N,V as R,X as j,n as le}from"./element-plus-DR-erZ3X.js";import"./echarts-Dfqt_Pbx.js";class ce{constructor(){this.scenarios=this.initializeScenarios(),this.currentScenario="general"}initializeScenarios(){return{general:{id:"general",name:"通用质量管理",description:"适用于一般性质量管理问答",icon:"🤖",category:"general",systemPrompt:`你是IQE质量管理系统的AI智能助手，专门负责质量管理数据分析和问答。

## 核心能力：
1. 数据分析和统计
2. 质量趋势分析  
3. 问题诊断和建议
4. 报告生成

## 回复要求：
- 使用专业术语但保持易懂
- 提供具体的数据支撑
- 给出可操作的建议
- 使用Markdown格式组织内容`,thinkingStyle:"systematic",analysisDepth:"standard",responseFormat:"markdown",toolPreferences:["chart","analysis"],maxTokens:2e3,temperature:.7},inventory:{id:"inventory",name:"库存管理专家",description:"专注于库存分析、风险评估、优化建议",icon:"📦",category:"business",systemPrompt:`你是专业的库存管理专家，具有丰富的供应链和仓储管理经验。

## 专业领域：
1. 库存水平分析和优化
2. 风险库存识别和处理
3. 供应商表现评估
4. 库存周转率分析
5. 安全库存计算

## 分析重点：
- 关注库存周转效率
- 识别滞销和短缺风险
- 评估供应商可靠性
- 提供库存优化策略

## 回复风格：
- 数据驱动的分析
- 具体的改进建议
- 风险等级评估
- ROI计算和成本分析`,thinkingStyle:"analytical",analysisDepth:"deep",responseFormat:"structured",toolPreferences:["pie_chart","trend_analysis","risk_assessment"],maxTokens:2500,temperature:.6},quality:{id:"quality",name:"质量检测专家",description:"专注于质量分析、缺陷诊断、改进措施",icon:"🔍",category:"business",systemPrompt:`你是资深的质量管理专家，专精于质量控制和持续改进。

## 专业领域：
1. 质量数据统计分析
2. 缺陷模式识别
3. 根因分析(RCA)
4. 质量改进建议
5. 质量成本分析

## 分析方法：
- 使用统计质量控制(SQC)方法
- 应用帕累托分析
- 进行趋势分析
- 实施PDCA循环思维

## 回复特点：
- 基于数据的客观分析
- 提供根因分析
- 给出具体改进措施
- 量化质量成本影响`,thinkingStyle:"methodical",analysisDepth:"deep",responseFormat:"analytical",toolPreferences:["control_chart","pareto_chart","fishbone"],maxTokens:3e3,temperature:.5},production:{id:"production",name:"生产管理专家",description:"专注于生产效率、工艺优化、产能分析",icon:"🏭",category:"business",systemPrompt:`你是经验丰富的生产管理专家，专注于制造业生产优化。

## 专业领域：
1. 生产效率分析
2. 工艺流程优化
3. 产能规划和调度
4. 设备效率(OEE)分析
5. 生产成本控制

## 分析视角：
- 关注生产效率指标
- 识别生产瓶颈
- 评估工艺稳定性
- 优化资源配置

## 回复重点：
- 提供效率提升方案
- 分析产能利用率
- 识别改进机会
- 量化效益预期`,thinkingStyle:"efficiency_focused",analysisDepth:"operational",responseFormat:"actionable",toolPreferences:["gantt_chart","efficiency_chart","capacity_analysis"],maxTokens:2500,temperature:.6},risk:{id:"risk",name:"风险管理专家",description:"专注于风险识别、评估、预警和控制",icon:"⚠️",category:"management",systemPrompt:`你是专业的风险管理专家，具备敏锐的风险识别和评估能力。

## 专业领域：
1. 质量风险识别和评估
2. 供应链风险分析
3. 合规风险管控
4. 预警机制设计
5. 应急响应策略

## 分析框架：
- 使用风险矩阵评估
- 应用FMEA分析方法
- 建立风险指标体系
- 制定缓解措施

## 回复特色：
- 突出风险等级
- 提供预警建议
- 制定应对策略
- 建立监控机制`,thinkingStyle:"risk_oriented",analysisDepth:"comprehensive",responseFormat:"risk_focused",toolPreferences:["risk_matrix","alert_dashboard","trend_monitoring"],maxTokens:2800,temperature:.4},decision:{id:"decision",name:"决策支持专家",description:"提供数据驱动的决策建议和战略分析",icon:"🎯",category:"management",systemPrompt:`你是高级管理顾问，专注于为管理层提供数据驱动的决策支持。

## 专业能力：
1. 战略数据分析
2. 多维度对比评估
3. ROI和成本效益分析
4. 趋势预测和建模
5. 决策方案评估

## 分析方法：
- 多角度数据对比
- 量化分析和建模
- 情景分析和预测
- 风险收益评估

## 回复风格：
- 高层次战略视角
- 数据支撑的结论
- 多方案对比分析
- 明确的行动建议`,thinkingStyle:"strategic",analysisDepth:"executive",responseFormat:"executive_summary",toolPreferences:["dashboard","comparison_chart","forecast_model"],maxTokens:3500,temperature:.7}}}getAllScenarios(){return Object.values(this.scenarios)}getScenarioCategories(){const e={};return Object.values(this.scenarios).forEach(t=>{e[t.category]||(e[t.category]=[]),e[t.category].push(t)}),e}getScenario(e){return this.scenarios[e]||this.scenarios.general}setCurrentScenario(e){return this.scenarios[e]?(this.currentScenario=e,!0):!1}getCurrentScenario(){return this.getScenario(this.currentScenario)}addCustomScenario(e){if(!e.id||this.scenarios[e.id])throw new Error("场景ID无效或已存在");return this.scenarios[e.id]={...e,category:e.category||"custom",isCustom:!0},!0}updateScenario(e,t){if(!this.scenarios[e])throw new Error("场景不存在");return this.scenarios[e]={...this.scenarios[e],...t},this.scenarios[e]}deleteScenario(e){const t=this.scenarios[e];if(!t||!t.isCustom)throw new Error("只能删除自定义场景");return delete this.scenarios[e],this.currentScenario===e&&(this.currentScenario="general"),!0}recommendScenario(e){const t=e.toLowerCase(),i={inventory:["库存","仓库","物料","供应商","入库","出库","库存量"],quality:["质量","检测","测试","缺陷","不良","合格率","质检"],production:["生产","产线","制造","工艺","产能","效率","产量"],risk:["风险","异常","预警","问题","故障","事故","隐患"],decision:["决策","对比","选择","评估","分析","建议","策略"]};let o=0,a="general";return Object.entries(i).forEach(([r,d])=>{const h=d.reduce((u,y)=>u+(t.includes(y)?1:0),0);h>o&&(o=h,a=r)}),{scenarioId:a,confidence:o>0?o/3*100:0,scenario:this.getScenario(a)}}saveToStorage(){const e={};Object.entries(this.scenarios).forEach(([t,i])=>{i.isCustom&&(e[t]=i)}),localStorage.setItem("aiScenarios",JSON.stringify({customScenarios:e,currentScenario:this.currentScenario}))}loadFromStorage(){try{const e=localStorage.getItem("aiScenarios");if(e){const{customScenarios:t,currentScenario:i}=JSON.parse(e);Object.entries(t||{}).forEach(([o,a])=>{this.scenarios[o]=a}),i&&this.scenarios[i]&&(this.currentScenario=i)}}catch(e){console.error("加载AI场景配置失败:",e)}}}const S=new ce;class ue{constructor(){this.rules=this.initializeRules(),this.scenarioPatterns=this.initializeScenarioPatterns()}initializeScenarioPatterns(){return{inventory:{keywords:["库存","仓库","物料","材料","供应商","入库","出库","库存量","安全库存"],patterns:[/查询.*库存/,/.*库存.*情况/,/.*仓库.*状态/,/.*物料.*数量/,/.*供应商.*库存/],entities:["factory","warehouse","materialCode","materialName","supplier"],confidence:.8},quality:{keywords:["质量","检测","测试","检验","合格","不良","缺陷","质检","品质"],patterns:[/质量.*分析/,/.*检测.*结果/,/.*合格率/,/.*不良率/,/.*质量.*趋势/],entities:["testResult","defectPhenomena","testDate"],confidence:.85},production:{keywords:["生产","产线","制造","工艺","产能","效率","产量","生产线"],patterns:[/生产.*效率/,/.*产线.*状态/,/.*产能.*分析/,/.*工艺.*优化/,/.*制造.*数据/],entities:["factory","baseline","project","defectRate"],confidence:.8},risk:{keywords:["风险","异常","预警","问题","故障","事故","隐患","警报"],patterns:[/风险.*评估/,/.*异常.*检测/,/.*预警.*分析/,/.*问题.*诊断/,/.*风险.*控制/],entities:["status","defectPhenomena","alertLevel"],confidence:.9},decision:{keywords:["决策","建议","对比","选择","评估","分析","策略","方案"],patterns:[/.*决策.*支持/,/.*建议.*方案/,/.*对比.*分析/,/.*评估.*结果/,/.*策略.*制定/],entities:["comparison","recommendation","strategy"],confidence:.7}}}initializeRules(){return{inventory:[{id:"inv_001",name:"库存状态查询",pattern:/查询.*库存.*状态/,action:"query_inventory_status",dataSource:["inventory"],response:"基于库存数据分析当前状态分布和风险等级"},{id:"inv_002",name:"供应商库存分析",pattern:/.*供应商.*库存/,action:"analyze_supplier_inventory",dataSource:["inventory"],response:"分析各供应商的库存表现和供应稳定性"},{id:"inv_003",name:"库存风险评估",pattern:/库存.*风险/,action:"assess_inventory_risk",dataSource:["inventory"],response:"识别风险库存，评估安全库存水平"}],quality:[{id:"qua_001",name:"质量趋势分析",pattern:/质量.*趋势/,action:"analyze_quality_trend",dataSource:["inspection","production"],response:"分析质量指标的时间趋势和变化模式"},{id:"qua_002",name:"不良率统计",pattern:/不良率.*统计/,action:"calculate_defect_rate",dataSource:["production","inspection"],response:"统计各维度的不良率并进行对比分析"},{id:"qua_003",name:"质量异常检测",pattern:/质量.*异常/,action:"detect_quality_anomaly",dataSource:["inspection"],response:"检测质量异常模式，提供改进建议"}],production:[{id:"pro_001",name:"生产效率分析",pattern:/生产.*效率/,action:"analyze_production_efficiency",dataSource:["production"],response:"分析生产效率指标，识别改进机会"},{id:"pro_002",name:"产能利用率",pattern:/产能.*利用/,action:"calculate_capacity_utilization",dataSource:["production"],response:"计算产能利用率，优化资源配置"}],risk:[{id:"ris_001",name:"风险识别评估",pattern:/风险.*识别/,action:"identify_risks",dataSource:["inventory","production","inspection"],response:"全面识别各类风险，进行等级评估"},{id:"ris_002",name:"预警分析",pattern:/预警.*分析/,action:"analyze_alerts",dataSource:["inventory","production","inspection"],response:"分析预警信号，制定应对策略"}],decision:[{id:"dec_001",name:"综合对比分析",pattern:/对比.*分析/,action:"comprehensive_comparison",dataSource:["inventory","production","inspection"],response:"多维度对比分析，提供决策建议"}]}}identifyScenario(e){const t=e.toLowerCase(),i=[];return Object.entries(this.scenarioPatterns).forEach(([o,a])=>{let r=0;const d=a.keywords.filter(y=>t.includes(y)).length;r+=d*10;const h=a.patterns.filter(y=>y.test(e)).length;r+=h*20;const u=a.entities.filter(y=>t.includes(y.toLowerCase())).length;r+=u*5,r>0&&i.push({scenarioId:o,score:r,confidence:Math.min(r/50*a.confidence,1),matchedKeywords:a.keywords.filter(y=>t.includes(y)),matchedPatterns:a.patterns.filter(y=>y.test(e))})}),i.sort((o,a)=>a.score-o.score),{primaryScenario:i[0]||null,allMatches:i,hasMatch:i.length>0}}matchRules(e,t){const i=this.rules[t]||[],o=[];return i.forEach(a=>{a.pattern.test(e)&&o.push({...a,matchConfidence:.9})}),{matchedRules:o,hasRules:o.length>0,primaryRule:o[0]||null}}generateRuleBasedResponse(e,t){if(!e.hasRules)return null;const i=e.primaryRule;let o=`## ${i.name}

`;return o+=`${i.response}

`,t&&t.totalRecords>0&&(o+=`### 数据分析结果
`,o+=`- 查询到 ${t.totalRecords} 条相关记录
`,Object.entries(t.sources).forEach(([a,r])=>{r.length>0&&(o+=`- ${a}: ${r.length} 条记录
`)})),o}processQuestion(e,t=null){console.log("🔍 增强场景引擎处理问题:",e);const i=this.preprocessQuestion(e),o=this.enhancedScenarioIdentification(i);console.log("📊 增强场景识别结果:",o);const a=this.intelligentRuleMatching(i,o);console.log("📋 智能规则匹配结果:",a);const r=this.analyzeContext(i,o),d=this.generateEnhancedResponse(a,t,r);return{scenarioMatch:o,ruleMatch:a,contextAnalysis:r,ruleBasedResponse:d,shouldUseRules:a.hasRules&&d!==null,processingStrategy:this.determineAdvancedStrategy(o,a,r),confidence:o.confidence}}preprocessQuestion(e){let t=e.trim().toLowerCase();const i={库存:["存货","库房","仓储","储存"],质量:["品质","质检","检验"],生产:["制造","产线","生产线"],供应商:["厂商","供货商","提供商"],检测:["测试","检验","检查"],分析:["统计","计算","评估"]};for(const[r,d]of Object.entries(i))d.forEach(h=>{t=t.replace(new RegExp(h,"g"),r)});const o=this.extractEntities(t),a=this.classifyIntent(t);return{original:e,cleaned:t,entities:o,intentType:a,keywords:this.extractKeywords(t)}}enhancedScenarioIdentification(e){const{cleaned:t,entities:i,intentType:o,keywords:a}=e,r=this.calculateKeywordScores(a),d=this.calculateEntityScores(i),h=this.calculateIntentScores(o),u=this.combineScores(r,d,h),y=this.determinePrimaryScenario(u);return{hasMatch:y.confidence>.6,primaryScenario:y,allScenarios:u,confidence:y.confidence,reasoning:this.generateScenarioReasoning(u,a,i)}}intelligentRuleMatching(e,t){if(!t.hasMatch)return{hasRules:!1,matchedRules:[],confidence:0};const i=t.primaryScenario.scenarioId,o=this.rules[i]||[],a=[];for(const r of o){const d=this.calculateRuleMatchScore(r,e);d>.5&&a.push({...r,matchScore:d,matchReason:this.generateMatchReason(r,e)})}return a.sort((r,d)=>d.matchScore-r.matchScore),{hasRules:a.length>0,matchedRules:a,confidence:a.length>0?a[0].matchScore:0,totalMatches:a.length}}analyzeContext(e,t){const{entities:i,intentType:o}=e;return{complexity:this.assessQuestionComplexity(e),urgency:this.assessUrgency(e),dataRequirements:this.identifyDataRequirements(i,t),responseFormat:this.determineOptimalResponseFormat(o,t),userExpertise:this.estimateUserExpertise(e)}}addRule(e,t){return this.rules[e]||(this.rules[e]=[]),t.id=t.id||`${e}_${Date.now()}`,this.rules[e].push(t),t.id}updateRule(e,t,i){const a=(this.rules[e]||[]).findIndex(r=>r.id===t);return a!==-1?(this.rules[e][a]={...this.rules[e][a],...i},!0):!1}deleteRule(e,t){const o=(this.rules[e]||[]).findIndex(a=>a.id===t);return o!==-1?(this.rules[e].splice(o,1),!0):!1}getScenarioRules(e){return this.rules[e]||[]}getRuleStatistics(){const e={};let t=0;return Object.entries(this.rules).forEach(([i,o])=>{e[i]=o.length,t+=o.length}),{byScenario:e,total:t}}extractEntities(e){const t={factories:[],materials:[],suppliers:[],timeRanges:[],metrics:[]};return["华东工厂","华南工厂","华北工厂","西南工厂"].forEach(r=>{e.includes(r.toLowerCase())&&t.factories.push(r)}),["电阻","电容","芯片","连接器","传感器"].forEach(r=>{e.includes(r)&&t.materials.push(r)}),[{pattern:/最近(\d+)天/,type:"days"},{pattern:/本周|这周/,type:"week"},{pattern:/本月|这个月/,type:"month"},{pattern:/今年|本年/,type:"year"}].forEach(({pattern:r,type:d})=>{const h=e.match(r);h&&t.timeRanges.push({type:d,value:h[1]||1})}),t}classifyIntent(e){const t={query:["查询","查看","显示","列出"],analysis:["分析","统计","计算","评估"],comparison:["对比","比较","差异","区别"],prediction:["预测","预估","趋势","未来"],report:["报告","报表","总结","汇总"]};for(const[i,o]of Object.entries(t))if(o.some(a=>e.includes(a)))return i;return"general"}extractKeywords(e){const t=["的","是","在","有","和","与","或","但","如果","那么"],i=e.split(/\s+/).filter(o=>o.length>1&&!t.includes(o));return[...new Set(i)]}calculateKeywordScores(e){const t={};for(const[i,o]of Object.entries(this.scenarioPatterns)){let a=0;const r=[];e.forEach(d=>{o.keywords.some(h=>h.includes(d)||d.includes(h))&&(a+=1,r.push(d))}),t[i]={score:a/Math.max(e.length,1),matchedKeywords:r,weight:.4}}return t}calculateEntityScores(e){const t={};for(const[i,o]of Object.entries(this.scenarioPatterns)){let a=0;const r=[];e.factories.length>0&&o.entities.includes("factory")&&(a+=.3,r.push("factory")),e.materials.length>0&&o.entities.includes("materialCode")&&(a+=.3,r.push("material")),t[i]={score:a,matchedEntities:r,weight:.3}}return t}calculateIntentScores(e){const i={query:{inventory:.8,quality:.6,production:.5},analysis:{quality:.9,production:.8,inventory:.7},comparison:{quality:.8,production:.7,inventory:.6},prediction:{production:.9,quality:.7,inventory:.6},report:{quality:.8,production:.8,inventory:.7}}[e]||{},o={};for(const a of Object.keys(this.scenarioPatterns))o[a]={score:i[a]||.1,intent:e,weight:.3};return o}combineScores(e,t,i){const o={};for(const a of Object.keys(this.scenarioPatterns)){const r=e[a]||{score:0,weight:.4},d=t[a]||{score:0,weight:.3},h=i[a]||{score:0,weight:.3},u=r.score*r.weight+d.score*d.weight+h.score*h.weight;o[a]={scenarioId:a,totalScore:u,confidence:Math.min(u,1),breakdown:{keyword:r,entity:d,intent:h}}}return o}determinePrimaryScenario(e){const t=Object.values(e);return t.sort((i,o)=>o.confidence-i.confidence),t[0]||{scenarioId:"general",confidence:0,totalScore:0}}generateScenarioReasoning(e,t,i){var r,d,h,u,y,I,O,V;const o=this.determinePrimaryScenario(e),a=[];return((h=(d=(r=o.breakdown)==null?void 0:r.keyword)==null?void 0:d.matchedKeywords)==null?void 0:h.length)>0&&a.push(`关键词匹配: ${o.breakdown.keyword.matchedKeywords.join(", ")}`),((I=(y=(u=o.breakdown)==null?void 0:u.entity)==null?void 0:y.matchedEntities)==null?void 0:I.length)>0&&a.push(`实体识别: ${o.breakdown.entity.matchedEntities.join(", ")}`),(V=(O=o.breakdown)==null?void 0:O.intent)!=null&&V.intent&&a.push(`意图类型: ${o.breakdown.intent.intent}`),a.join("; ")}calculateRuleMatchScore(e,t){const{cleaned:i,keywords:o}=t;let a=0;e.pattern&&e.pattern.test(i)&&(a+=.6);const r=e.name.toLowerCase().split(/\s+/),d=o.filter(h=>r.some(u=>u.includes(h)||h.includes(u)));return d.length>0&&(a+=.4*(d.length/Math.max(r.length,o.length))),Math.min(a,1)}generateMatchReason(e,t){const i=[];e.pattern&&e.pattern.test(t.cleaned)&&i.push("模式匹配");const o=e.name.toLowerCase().split(/\s+/),a=t.keywords.filter(r=>o.some(d=>d.includes(r)||r.includes(d)));return a.length>0&&i.push(`关键词匹配: ${a.join(", ")}`),i.join("; ")}assessQuestionComplexity(e){const{keywords:t,entities:i}=e;let o="simple";return(t.length>5||Object.values(i).some(a=>a.length>2))&&(o="medium"),(t.length>10||Object.values(i).some(a=>a.length>5))&&(o="complex"),o}assessUrgency(e){const t=["紧急","立即","马上","急需","重要"],{cleaned:i}=e;return t.some(o=>i.includes(o))?"high":"normal"}identifyDataRequirements(e,t){const i=[];return e.factories.length>0&&i.push("factory_data"),e.materials.length>0&&i.push("material_data"),e.timeRanges.length>0&&i.push("time_series_data"),t.primaryScenario.scenarioId==="quality"&&i.push("quality_metrics"),i}determineOptimalResponseFormat(e,t){return{query:"structured_list",analysis:"detailed_analysis",comparison:"comparison_table",prediction:"trend_chart",report:"comprehensive_report"}[e]||"general_response"}estimateUserExpertise(e){const t=["合格率","不良率","cpk","spc","六西格玛","质量控制"],{cleaned:i}=e,o=t.filter(a=>i.includes(a)).length;return o>=2?"expert":o>=1?"intermediate":"beginner"}determineAdvancedStrategy(e,t,i){return t.hasRules&&t.confidence>.8?"rule_based":e.confidence>.7?"scenario_guided":i.complexity==="complex"?"ai_enhanced":"ai_generated"}generateEnhancedResponse(e,t,i){if(!e.hasRules||e.matchedRules.length===0)return null;let a=e.matchedRules[0].response;return i.userExpertise==="expert"?a+=`

技术细节: 基于专业质量管理标准进行深度分析。`:i.userExpertise==="beginner"&&(a+=`

说明: 以下是基础分析结果，如需详细解释请告知。`),i.urgency==="high"&&(a="⚠️ 紧急响应: "+a),a}}const B=new ue,de={class:"scenario-management"},pe={class:"page-header"},me={class:"header-content"},he={class:"header-left"},ye={class:"stats-bar"},fe={class:"stat-item"},ge={class:"stat-content"},ve={class:"stat-value"},_e={class:"stat-item"},Se={class:"stat-content"},we={class:"stat-value"},be={class:"stat-item"},ke={class:"stat-content"},Re={class:"stat-value"},Ce={class:"header-actions"},xe={class:"current-scenario"},Ve={class:"scenario-status"},Pe={class:"status-info"},Ee={class:"status-badge"},Me={class:"status-icon"},De={class:"status-name"},Ie={class:"status-actions"},Oe={class:"design-workspace"},qe={class:"design-category"},$e={class:"category-header"},je={class:"category-count"},Fe={class:"scenario-designer-grid"},Ue={class:"design-preview"},ze={class:"preview-header"},Ae={class:"scenario-icon"},Te={class:"scenario-info"},Ke={class:"scenario-name"},Le={class:"scenario-desc"},Ne={class:"scenario-status"},Be={class:"config-overview"},Qe={class:"config-item"},Je={class:"config-value"},We={class:"config-item"},Xe={class:"config-value"},Ge={class:"config-item"},He={class:"config-value"},Ye={class:"rules-stats"},Ze={class:"stat-item"},et={class:"stat-number"},tt={class:"stat-item"},st={class:"stat-number"},nt={class:"design-actions"},at={class:"scenario-designer"},ot={class:"design-section"},it={class:"form-grid"},rt={class:"design-section"},lt={class:"form-grid"},ct={class:"slider-container"},ut={class:"slider-desc"},dt={class:"design-section"},pt={class:"prompt-editor"},mt={class:"design-section"},ht={class:"section-title"},yt={class:"rules-list"},ft={class:"rule-header"},gt={class:"rule-content"},vt={key:0,class:"empty-rules"},_t={class:"dialog-footer"},St={__name:"AIScenarioManagementSimple",setup(F){const e=w([]),t=w({}),i=w(""),o=w(null),a=w(null);w(!1);const r=w(!1),d=w(!1),h=w(!1),u=w({name:"",icon:"🎯",description:"",thinkingStyle:"systematic",analysisDepth:"standard",responseFormat:"structured",temperature:.7,systemPrompt:"",rules:[]}),y=w([{value:"🎯",label:"目标导向"},{value:"🔍",label:"分析调研"},{value:"📊",label:"数据分析"},{value:"⚙️",label:"流程优化"},{value:"🧠",label:"智能决策"},{value:"📈",label:"趋势预测"},{value:"🔧",label:"问题解决"},{value:"💡",label:"创新思维"}]),I=L(()=>e.value),O=L(()=>B.getRuleStatistics().total),V=()=>{e.value=S.getAllScenarios(),t.value=S.getCurrentScenario(),i.value=t.value.id},Q=p=>{S.setCurrentScenario(p)&&(t.value=S.getCurrentScenario(),S.saveToStorage(),R.success(`已切换到场景：${t.value.name}`),V())},J=()=>{d.value=!0},W=p=>B.getScenarioRules(p).length,X=p=>{a.value={...p},u.value={name:p.name||"",icon:p.icon||"🎯",description:p.description||"",thinkingStyle:p.thinkingStyle||"systematic",analysisDepth:p.analysisDepth||"standard",responseFormat:p.responseFormat||"structured",temperature:p.temperature||.7,systemPrompt:p.systemPrompt||"",rules:p.rules?[...p.rules]:[]},r.value=!0},G=p=>{S.setCurrentScenario(p.id)&&(t.value=S.getCurrentScenario(),S.saveToStorage(),R.success(`已激活场景：${p.name}`),V())},H=p=>{o.value=p,d.value=!0},Y=()=>{u.value.rules.push({name:"",pattern:"",response:""})},Z=p=>{u.value.rules.splice(p,1)},ee=p=>`${p} (${U(p)})`,U=p=>p<=.3?"保守稳定":p<=.5?"平衡适中":p<=.7?"灵活创新":"高度创造",te=()=>{console.log("预览场景配置:",u.value),R.info("场景预览功能开发中...")},se=()=>{var p,n;if(!u.value.name.trim()){R.error("请输入场景名称");return}if(!u.value.description.trim()){R.error("请输入场景描述");return}if(!u.value.systemPrompt.trim()){R.error("请输入系统提示词");return}try{const g={id:((p=a.value)==null?void 0:p.id)||`scenario_${Date.now()}`,...u.value,isCustom:!0,createdAt:((n=a.value)==null?void 0:n.createdAt)||Date.now(),updatedAt:Date.now()};a.value?(S.updateScenario(g.id,g),R.success("场景更新成功")):(S.addScenario(g),R.success("场景创建成功")),S.saveToStorage(),V(),r.value=!1,ne()}catch(g){console.error("保存场景失败:",g),R.error("保存场景失败")}},ne=()=>{u.value={name:"",icon:"🎯",description:"",thinkingStyle:"systematic",analysisDepth:"standard",responseFormat:"structured",temperature:.7,systemPrompt:"",rules:[]},a.value=null};return re(()=>{console.log("🎭 AI场景管理页面已加载"),S.loadFromStorage(),V()}),(p,n)=>{var A,T,K;const g=x("el-button"),_=x("el-option"),M=x("el-select"),ae=x("el-tag"),P=x("el-input"),k=x("el-form-item"),oe=x("el-slider"),z=x("el-dialog");return b(),C("div",de,[s("div",pe,[s("div",me,[s("div",he,[n[20]||(n[20]=s("h1",{class:"page-title"},[s("span",{class:"title-icon"},"🎭"),v(" AI场景管理 ")],-1)),n[21]||(n[21]=s("p",{class:"page-description"},"设计和配置智能场景，定义AI助手在不同业务场景下的行为模式、分析策略和响应规则",-1)),s("div",ye,[s("div",fe,[n[15]||(n[15]=s("span",{class:"stat-icon"},"📊",-1)),s("div",ge,[n[14]||(n[14]=s("span",{class:"stat-label"},"总场景数",-1)),s("span",ve,f(I.value.length),1)])]),s("div",_e,[n[17]||(n[17]=s("span",{class:"stat-icon"},"⚡",-1)),s("div",Se,[n[16]||(n[16]=s("span",{class:"stat-label"},"活跃场景",-1)),s("span",we,f(((A=t.value)==null?void 0:A.name)||"无"),1)])]),s("div",be,[n[19]||(n[19]=s("span",{class:"stat-icon"},"📋",-1)),s("div",ke,[n[18]||(n[18]=s("span",{class:"stat-label"},"总规则数",-1)),s("span",Re,f(O.value),1)])])])]),s("div",Ce,[c(g,{type:"primary",onClick:n[0]||(n[0]=l=>r.value=!0)},{default:m(()=>n[22]||(n[22]=[s("span",{class:"button-icon"},"🎨",-1),v(" 设计新场景 ")])),_:1,__:[22]}),c(g,{onClick:n[1]||(n[1]=l=>h.value=!0)},{default:m(()=>n[23]||(n[23]=[s("span",{class:"button-icon"},"⚙️",-1),v(" 规则设计器 ")])),_:1,__:[23]}),c(g,{onClick:J},{default:m(()=>n[24]||(n[24]=[s("span",{class:"button-icon"},"🧪",-1),v(" 测试验证 ")])),_:1,__:[24]})])])]),s("div",xe,[s("div",Ve,[s("div",Pe,[n[25]||(n[25]=s("span",{class:"status-label"},"当前激活场景:",-1)),s("div",Ee,[s("span",Me,f(((T=t.value)==null?void 0:T.icon)||"🤖"),1),s("span",De,f(((K=t.value)==null?void 0:K.name)||"未选择"),1)])]),s("div",Ie,[c(M,{modelValue:i.value,"onUpdate:modelValue":n[2]||(n[2]=l=>i.value=l),onChange:Q,placeholder:"切换场景",style:{width:"200px"}},{default:m(()=>[(b(!0),C(q,null,$(e.value,l=>(b(),j(_,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])])]),s("div",Oe,[s("div",qe,[s("div",$e,[n[26]||(n[26]=s("span",{class:"category-icon"},"🎯",-1)),n[27]||(n[27]=s("h3",{class:"category-name"},"业务场景",-1)),s("span",je,f(e.value.length)+"个场景",1)]),s("div",Fe,[(b(!0),C(q,null,$(e.value,l=>(b(),C("div",{key:l.id,class:le(["scenario-designer-card",{active:l.id===t.value.id,custom:l.isCustom}])},[s("div",Ue,[s("div",ze,[s("span",Ae,f(l.icon),1),s("div",Te,[s("h4",Ke,f(l.name),1),s("p",Le,f(l.description),1)]),s("div",Ne,[c(ae,{type:l.id===t.value.id?"success":"info",size:"small"},{default:m(()=>[v(f(l.id===t.value.id?"激活中":"待用"),1)]),_:2},1032,["type"])])]),s("div",Be,[s("div",Qe,[n[28]||(n[28]=s("span",{class:"config-label"},"思考方式:",-1)),s("span",Je,f(l.thinkingStyle),1)]),s("div",We,[n[29]||(n[29]=s("span",{class:"config-label"},"分析深度:",-1)),s("span",Xe,f(l.analysisDepth),1)]),s("div",Ge,[n[30]||(n[30]=s("span",{class:"config-label"},"响应格式:",-1)),s("span",He,f(l.responseFormat),1)])]),s("div",Ye,[s("div",Ze,[s("span",et,f(W(l.id)),1),n[31]||(n[31]=s("span",{class:"stat-label"},"业务规则",-1))]),s("div",tt,[s("span",st,f(l.temperature||.7),1),n[32]||(n[32]=s("span",{class:"stat-label"},"创造性",-1))])])]),s("div",nt,[c(g,{size:"small",type:"primary",onClick:D=>X(l)},{default:m(()=>n[33]||(n[33]=[s("span",{class:"action-icon"},"🎨",-1),v(" 设计配置 ")])),_:2,__:[33]},1032,["onClick"]),l.id!==t.value.id?(b(),j(g,{key:0,size:"small",onClick:D=>G(l)},{default:m(()=>n[34]||(n[34]=[s("span",{class:"action-icon"},"⚡",-1),v(" 激活 ")])),_:2,__:[34]},1032,["onClick"])):N("",!0),c(g,{size:"small",onClick:D=>H(l)},{default:m(()=>n[35]||(n[35]=[s("span",{class:"action-icon"},"🧪",-1),v(" 测试 ")])),_:2,__:[35]},1032,["onClick"])])],2))),128))])])]),c(z,{modelValue:r.value,"onUpdate:modelValue":n[12]||(n[12]=l=>r.value=l),title:a.value?"编辑场景配置":"设计新场景",width:"800px",class:"scenario-design-dialog"},{footer:m(()=>[s("div",_t,[c(g,{onClick:n[11]||(n[11]=l=>r.value=!1)},{default:m(()=>n[45]||(n[45]=[v("取消")])),_:1,__:[45]}),c(g,{onClick:te,icon:"View"},{default:m(()=>n[46]||(n[46]=[v("预览效果")])),_:1,__:[46]}),c(g,{type:"primary",onClick:se,icon:"Check"},{default:m(()=>[v(f(a.value?"保存修改":"创建场景"),1)]),_:1})])]),default:m(()=>[s("div",at,[s("div",ot,[n[36]||(n[36]=s("h4",{class:"section-title"},[s("span",{class:"section-icon"},"📋"),v(" 基础信息 ")],-1)),s("div",it,[c(k,{label:"场景名称"},{default:m(()=>[c(P,{modelValue:u.value.name,"onUpdate:modelValue":n[3]||(n[3]=l=>u.value.name=l),placeholder:"请输入场景名称",maxlength:"50","show-word-limit":""},null,8,["modelValue"])]),_:1}),c(k,{label:"场景图标"},{default:m(()=>[c(M,{modelValue:u.value.icon,"onUpdate:modelValue":n[4]||(n[4]=l=>u.value.icon=l),placeholder:"选择图标"},{default:m(()=>[(b(!0),C(q,null,$(y.value,l=>(b(),j(_,{key:l.value,label:l.label,value:l.value},{default:m(()=>[s("span",null,f(l.value)+" "+f(l.label),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),c(k,{label:"场景描述",class:"full-width"},{default:m(()=>[c(P,{modelValue:u.value.description,"onUpdate:modelValue":n[5]||(n[5]=l=>u.value.description=l),type:"textarea",rows:3,placeholder:"请描述该场景的应用范围和特点",maxlength:"200","show-word-limit":""},null,8,["modelValue"])]),_:1})])]),s("div",rt,[n[37]||(n[37]=s("h4",{class:"section-title"},[s("span",{class:"section-icon"},"🧠"),v(" AI行为配置 ")],-1)),s("div",lt,[c(k,{label:"思考方式"},{default:m(()=>[c(M,{modelValue:u.value.thinkingStyle,"onUpdate:modelValue":n[6]||(n[6]=l=>u.value.thinkingStyle=l),placeholder:"选择思考方式"},{default:m(()=>[c(_,{label:"逻辑分析",value:"logical"}),c(_,{label:"创新思维",value:"creative"}),c(_,{label:"系统思考",value:"systematic"}),c(_,{label:"批判性思维",value:"critical"})]),_:1},8,["modelValue"])]),_:1}),c(k,{label:"分析深度"},{default:m(()=>[c(M,{modelValue:u.value.analysisDepth,"onUpdate:modelValue":n[7]||(n[7]=l=>u.value.analysisDepth=l),placeholder:"选择分析深度"},{default:m(()=>[c(_,{label:"快速概览",value:"quick"}),c(_,{label:"标准分析",value:"standard"}),c(_,{label:"深度分析",value:"deep"}),c(_,{label:"专家级分析",value:"expert"})]),_:1},8,["modelValue"])]),_:1}),c(k,{label:"响应格式"},{default:m(()=>[c(M,{modelValue:u.value.responseFormat,"onUpdate:modelValue":n[8]||(n[8]=l=>u.value.responseFormat=l),placeholder:"选择响应格式"},{default:m(()=>[c(_,{label:"结构化报告",value:"structured"}),c(_,{label:"对话式回答",value:"conversational"}),c(_,{label:"要点总结",value:"bullet_points"}),c(_,{label:"图表展示",value:"visual"})]),_:1},8,["modelValue"])]),_:1}),c(k,{label:"创造性参数"},{default:m(()=>[s("div",ct,[c(oe,{modelValue:u.value.temperature,"onUpdate:modelValue":n[9]||(n[9]=l=>u.value.temperature=l),min:0,max:1,step:.1,"show-tooltip":"","format-tooltip":ee},null,8,["modelValue"]),s("span",ut,f(U(u.value.temperature)),1)])]),_:1})])]),s("div",dt,[n[39]||(n[39]=s("h4",{class:"section-title"},[s("span",{class:"section-icon"},"💬"),v(" 系统提示词 ")],-1)),s("div",pt,[c(P,{modelValue:u.value.systemPrompt,"onUpdate:modelValue":n[10]||(n[10]=l=>u.value.systemPrompt=l),type:"textarea",rows:6,placeholder:"请输入系统提示词，定义AI在该场景下的角色和行为...",maxlength:"1000","show-word-limit":""},null,8,["modelValue"]),n[38]||(n[38]=s("div",{class:"prompt-tips"},[s("div",{class:"tip-item"},[s("span",{class:"tip-icon"},"💡"),s("span",{class:"tip-text"},"提示词应该明确定义AI的角色、专业领域和回答风格")]),s("div",{class:"tip-item"},[s("span",{class:"tip-icon"},"📝"),s("span",{class:"tip-text"},"可以包含具体的分析框架、方法论和输出要求")])],-1))])]),s("div",mt,[s("h4",ht,[n[41]||(n[41]=s("span",{class:"section-icon"},"⚙️",-1)),n[42]||(n[42]=v(" 业务规则 ")),c(g,{size:"small",type:"primary",onClick:Y},{default:m(()=>n[40]||(n[40]=[s("span",{class:"button-icon"},"➕",-1),v(" 添加规则 ")])),_:1,__:[40]})]),s("div",yt,[(b(!0),C(q,null,$(u.value.rules,(l,D)=>(b(),C("div",{key:D,class:"rule-item"},[s("div",ft,[c(P,{modelValue:l.name,"onUpdate:modelValue":E=>l.name=E,placeholder:"规则名称",size:"small",style:{width:"200px"}},null,8,["modelValue","onUpdate:modelValue"]),c(g,{size:"small",type:"danger",onClick:E=>Z(D),icon:"Delete"},{default:m(()=>n[43]||(n[43]=[v(" 删除 ")])),_:2,__:[43]},1032,["onClick"])]),s("div",gt,[c(k,{label:"触发条件"},{default:m(()=>[c(P,{modelValue:l.pattern,"onUpdate:modelValue":E=>l.pattern=E,placeholder:"输入关键词或正则表达式"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),c(k,{label:"回答模板"},{default:m(()=>[c(P,{modelValue:l.response,"onUpdate:modelValue":E=>l.response=E,type:"textarea",rows:3,placeholder:"定义该规则的标准回答模板..."},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)])]))),128)),u.value.rules.length===0?(b(),C("div",vt,n[44]||(n[44]=[s("span",{class:"empty-icon"},"📋",-1),s("span",{class:"empty-text"},'暂无业务规则，点击"添加规则"开始配置',-1)]))):N("",!0)])])])]),_:1},8,["modelValue","title"]),c(z,{modelValue:d.value,"onUpdate:modelValue":n[13]||(n[13]=l=>d.value=l),title:"场景测试",width:"700px"},{default:m(()=>n[47]||(n[47]=[s("div",{class:"test-content"},[s("p",null,"场景测试功能开发中...")],-1)])),_:1,__:[47]},8,["modelValue"])])}}},Rt=ie(St,[["__scopeId","data-v-68982290"]]);export{Rt as default};
