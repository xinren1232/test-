import{S as h,c as d,o as c,a as t,b as D,O as o,P as n,e as v,Q as p,a0 as T,aq as O,G as E,t as r,F as C,r as M,n as R,X as P,V as w}from"./element-plus-DR-erZ3X.js";import{a as V}from"./index-Bo1zM2q5.js";import"./echarts-Dfqt_Pbx.js";const $={class:"test-real-data-page"},q={class:"test-section"},J={class:"test-controls"},L={key:0,class:"test-result"},j={class:"result-header"},z={class:"result-info"},F={key:0,class:"key-metrics"},G={class:"metrics-grid"},H={class:"metric-label"},I={class:"metric-value"},X={key:1,class:"data-table-section"},A={class:"raw-response"},K={__name:"TestRealDataDisplay",setup(Q){const g=h(!1),s=h(null),S=async()=>{var e,m,f,b;g.value=!0;const l=Date.now();try{console.log("🧪 开始测试真实数据...");const a=await fetch("/api/assistant/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:"深圳工厂的库存情况"})}),y=Date.now()-l;if(!a.ok)throw new Error(`HTTP ${a.status}: ${a.statusText}`);const u=await a.json();console.log("✅ 真实数据测试成功:",u),s.value={success:!0,source:u.source||"API",count:((m=(e=u.data)==null?void 0:e.tableData)==null?void 0:m.length)||0,responseTime:y,keyMetrics:((f=u.data)==null?void 0:f.keyMetrics)||[],tableData:((b=u.data)==null?void 0:b.tableData)||[],rawResponse:u},w.success(`真实数据测试成功，获取到 ${s.value.count} 条记录`)}catch(a){console.error("❌ 真实数据测试失败:",a),s.value={success:!1,source:"Error",count:0,responseTime:Date.now()-l,error:a.message,rawResponse:{error:a.message}},w.error(`真实数据测试失败: ${a.message}`)}finally{g.value=!1}},x=()=>{console.log("🎭 生成模拟数据测试...");const l={success:!0,data:{answer:'根据您的查询"深圳工厂的库存情况"，找到了 5 条相关记录。',tableData:[{工厂:"深圳工厂",物料编码:"SPK-瑞6984",物料名称:"喇叭",供应商:"瑞声",数量:137,状态:"正常",入库时间:"2025-07-10"},{工厂:"深圳工厂",物料编码:"BOX-富5172",物料名称:"包装盒",供应商:"富群",数量:1024,状态:"正常",入库时间:"2025-07-10"},{工厂:"深圳工厂",物料编码:"DEC-欣7269",物料名称:"装饰件",供应商:"欣冠",数量:319,状态:"正常",入库时间:"2025-07-10"},{工厂:"深圳工厂",物料编码:"CHG-理8507",物料名称:"充电器",供应商:"理威",数量:962,状态:"正常",入库时间:"2025-07-10"},{工厂:"深圳工厂",物料编码:"DS-L-B4188",物料名称:"LCD显示屏",供应商:"BOE",数量:476,状态:"风险",入库时间:"2025-07-10"}],keyMetrics:[{label:"总记录数",value:5,trend:"stable"},{label:"正常状态",value:4,trend:"up"},{label:"风险状态",value:1,trend:"down"}]},source:"mock"};s.value={success:!0,source:"Mock Data",count:l.data.tableData.length,responseTime:50,keyMetrics:l.data.keyMetrics,tableData:l.data.tableData,rawResponse:l},w.success(`模拟数据测试成功，生成 ${s.value.count} 条记录`)},B=(l,e)=>l==="状态"?e==="正常"?"status-normal":e==="风险"?"status-risk":"":"";return(l,e)=>{const m=p("el-icon"),f=p("el-button"),b=p("el-tag"),a=p("el-table-column"),y=p("el-table"),u=p("el-collapse-item"),N=p("el-collapse");return c(),d("div",$,[e[9]||(e[9]=t("div",{class:"page-header"},[t("h1",null,"🧪 真实数据显示测试"),t("p",null,"测试前端是否能正确显示后端返回的真实数据")],-1)),t("div",q,[t("div",J,[o(f,{type:"primary",onClick:S,loading:g.value},{default:n(()=>[o(m,null,{default:n(()=>[o(T(O))]),_:1}),e[0]||(e[0]=v(" 测试真实数据 "))]),_:1,__:[0]},8,["loading"]),o(f,{type:"success",onClick:x},{default:n(()=>[o(m,null,{default:n(()=>[o(T(E))]),_:1}),e[1]||(e[1]=v(" 测试模拟数据 "))]),_:1,__:[1]})]),s.value?(c(),d("div",L,[t("div",j,[e[2]||(e[2]=t("h3",null,"📊 测试结果",-1)),o(b,{type:s.value.success?"success":"danger"},{default:n(()=>[v(r(s.value.success?"成功":"失败"),1)]),_:1},8,["type"])]),t("div",z,[t("p",null,[e[3]||(e[3]=t("strong",null,"数据源:",-1)),v(" "+r(s.value.source),1)]),t("p",null,[e[4]||(e[4]=t("strong",null,"记录数:",-1)),v(" "+r(s.value.count),1)]),t("p",null,[e[5]||(e[5]=t("strong",null,"响应时间:",-1)),v(" "+r(s.value.responseTime)+"ms",1)])]),s.value.keyMetrics&&s.value.keyMetrics.length>0?(c(),d("div",F,[e[6]||(e[6]=t("h4",null,"📈 关键指标",-1)),t("div",G,[(c(!0),d(C,null,M(s.value.keyMetrics,i=>(c(),d("div",{key:i.label,class:"metric-card"},[t("div",H,r(i.label),1),t("div",I,r(i.value),1),t("div",{class:R(["metric-trend",i.trend])},r(i.trend==="up"?"📈":i.trend==="down"?"📉":"➡️"),3)]))),128))])])):D("",!0),s.value.tableData&&s.value.tableData.length>0?(c(),d("div",X,[e[7]||(e[7]=t("h4",null,"📋 数据表格",-1)),o(y,{data:s.value.tableData,style:{width:"100%"},stripe:"",border:"",size:"small","max-height":"400","header-cell-style":{background:"#f8fafc",color:"#374151",fontWeight:"600"}},{default:n(()=>[(c(!0),d(C,null,M(s.value.tableData[0]||{},(i,_)=>(c(),P(a,{key:_,prop:_,label:_,"show-overflow-tooltip":""},{default:n(k=>[t("span",{class:R(B(_,k.row[_]))},r(k.row[_]),3)]),_:2},1032,["prop","label"]))),128))]),_:1},8,["data"])])):D("",!0),t("div",A,[e[8]||(e[8]=t("h4",null,"🔍 原始响应数据",-1)),o(N,null,{default:n(()=>[o(u,{title:"查看原始JSON数据",name:"raw"},{default:n(()=>[t("pre",null,r(JSON.stringify(s.value.rawResponse,null,2)),1)]),_:1})]),_:1})])])):D("",!0)])])}}},Z=V(K,[["__scopeId","data-v-f2e13260"]]);export{Z as default};
