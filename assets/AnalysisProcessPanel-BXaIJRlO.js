/* empty css                                                                             */import{a as v}from"./index-Bo1zM2q5.js";import{c as a,o as n,a as s,n as d,t as o,b as f,d as y,F as c,r as m,e as _}from"./element-plus-DR-erZ3X.js";const p={name:"AnalysisProcessPanel",props:{workflow:{type:Object,default:null}},computed:{processStatus(){return this.workflow?this.workflow.status||"processing":"waiting"},totalSteps(){var e,t;return((t=(e=this.workflow)==null?void 0:e.steps)==null?void 0:t.length)||8},completedSteps(){var e,t;return((t=(e=this.workflow)==null?void 0:e.steps)==null?void 0:t.filter(u=>u.status==="completed").length)||0},overallProgress(){return this.totalSteps>0?this.completedSteps/this.totalSteps*100:0}},methods:{getStatusText(){switch(this.processStatus){case"waiting":return"等待中";case"processing":return"分析中";case"completed":return"已完成";case"failed":return"处理失败";default:return"未知状态"}},getStepClass(e){return{"step-completed":e.status==="completed","step-processing":e.status==="processing","step-failed":e.status==="failed","step-pending":!e.status||e.status==="pending"}},getStepIcon(e){return{1:"fas fa-brain",2:"fas fa-database",3:"fas fa-search",4:"fas fa-chart-bar",5:"fas fa-tools",6:"fas fa-robot",7:"fas fa-sort",8:"fas fa-check"}[e.step]||"fas fa-circle"},getStepStatusText(e){switch(e){case"completed":return"✅ 完成";case"processing":return"🔄 处理中";case"failed":return"❌ 失败";default:return"⏳ 等待"}},getStepDuration(e){return e.startTime&&e.endTime?new Date(e.endTime)-new Date(e.startTime):0},getIntentText(e){return{"general-query":"一般查询","data-query":"数据查询","analysis-query":"分析查询","system-query":"系统查询"}[e]||e},getComplexityText(e){return{low:"简单",medium:"中等",high:"复杂"}[e]||e},getToolIcon(e){return{chart:"fas fa-chart-line",search:"fas fa-search",stats:"fas fa-calculator"}[e]||"fas fa-tool"},getToolName(e){return{chart:"图表生成",search:"网络搜索",stats:"统计计算"}[e]||e},getAnalysisPreview(e){return typeof e=="string"?e.length>100?e.substring(0,100)+"...":e:"分析完成"},getDataQualityText(e){return{high:"高质量",medium:"中等质量",low:"低质量"}[e]||e},getDataSourceSummary(){var t;if(!((t=this.workflow)!=null&&t.steps))return"";const e=this.workflow.steps.find(u=>u.step===2);return e!=null&&e.result?e.result.map(u=>u.table).join(", "):""}}},h={class:"analysis-process-panel"},k={class:"panel-header"},w={key:0,class:"workflow-container"},x={class:"overall-progress"},S={class:"progress-bar"},T={class:"progress-text"},b={class:"steps-container"},q={class:"step-header"},D={class:"step-icon"},I={class:"step-info"},P={class:"step-title"},A={key:0,class:"step-time"},C={class:"step-status"},N={key:0,class:"step-content"},F={key:0,class:"intent-result"},Q={class:"result-item"},z={class:"result-item"},B={class:"confidence"},V={class:"result-item"},j={class:"keywords"},E={class:"result-item"},L={key:1,class:"datasource-result"},O={class:"result-item"},R={class:"datasources"},G={class:"source-name"},H={class:"source-desc"},J={key:2,class:"query-result"},K={class:"result-item"},M={class:"queries"},U={class:"query-header"},W={class:"table-name"},X={class:"query-desc"},Y={key:3,class:"summary-result"},Z={class:"result-item"},$={class:"summary-stats"},ss={class:"stat-item"},ts={class:"stat-item"},es={key:4,class:"tool-result"},ls={class:"result-item"},as={key:0,class:"tools"},ns={key:1,class:"no-tools"},os={key:5,class:"ai-analysis-result"},rs={class:"result-item"},is={class:"analysis-preview"},us={key:6,class:"organize-result"},ds={class:"result-item"},cs={key:7,class:"final-result"},ms={class:"result-item"},fs={class:"final-stats"},_s={class:"stat-item"},gs={class:"stat-item"},vs={key:1,class:"step-processing"},ys={key:2,class:"step-error"},ps={key:0,class:"workflow-summary"},hs={class:"summary-content"},ks={class:"summary-item"},ws={class:"summary-item"},xs={key:1,class:"empty-state"};function Ss(e,t,u,Ts,bs,r){return n(),a("div",h,[s("div",k,[t[0]||(t[0]=s("h3",null,"🔍 分析过程",-1)),s("div",{class:d(["process-status",r.processStatus])},o(r.getStatusText()),3)]),u.workflow?(n(),a("div",w,[s("div",x,[s("div",S,[s("div",{class:"progress-fill",style:y({width:`${r.overallProgress}%`})},null,4)]),s("div",T,o(r.completedSteps)+"/"+o(r.totalSteps)+" 步骤完成 ",1)]),s("div",b,[(n(!0),a(c,null,m(u.workflow.steps,(l,g)=>(n(),a("div",{key:g,class:d(["step-item",r.getStepClass(l)])},[s("div",q,[s("div",D,[s("i",{class:d(r.getStepIcon(l))},null,2)]),s("div",I,[s("div",P," 步骤"+o(l.step)+": "+o(l.name),1),l.endTime?(n(),a("div",A," 耗时: "+o(r.getStepDuration(l))+"ms ",1)):f("",!0)]),s("div",C,[s("span",{class:d("status-"+l.status)},o(r.getStepStatusText(l.status)),3)])]),l.result&&l.status==="completed"?(n(),a("div",N,[l.step===1?(n(),a("div",F,[s("div",Q,[t[1]||(t[1]=s("strong",null,"识别意图:",-1)),s("span",{class:d(["intent-tag","intent-"+l.result.intent])},o(r.getIntentText(l.result.intent)),3)]),s("div",z,[t[2]||(t[2]=s("strong",null,"置信度:",-1)),s("span",B,o((l.result.confidence*100).toFixed(1))+"%",1)]),s("div",V,[t[3]||(t[3]=s("strong",null,"关键词:",-1)),s("span",j,[(n(!0),a(c,null,m(l.result.keywords,i=>(n(),a("span",{key:i,class:"keyword-tag"},o(i),1))),128))])]),s("div",E,[t[4]||(t[4]=s("strong",null,"复杂度:",-1)),s("span",{class:d(["complexity","complexity-"+l.result.complexity])},o(r.getComplexityText(l.result.complexity)),3)])])):l.step===2?(n(),a("div",L,[s("div",O,[t[6]||(t[6]=s("strong",null,"选中数据源:",-1)),s("div",R,[(n(!0),a(c,null,m(l.result,i=>(n(),a("div",{key:i.table,class:"datasource-item"},[t[5]||(t[5]=s("i",{class:"fas fa-database"},null,-1)),s("span",G,o(i.table),1),s("span",H,o(i.description),1)]))),128))])])])):l.step===3?(n(),a("div",J,[s("div",K,[t[8]||(t[8]=s("strong",null,"执行查询:",-1)),s("div",M,[(n(!0),a(c,null,m(l.result.results,i=>(n(),a("div",{key:i.source,class:"query-item"},[s("div",U,[t[7]||(t[7]=s("i",{class:"fas fa-table"},null,-1)),s("span",W,o(i.source),1),s("span",{class:d(["record-count",i.count>0?"has-data":"no-data"])},o(i.count)+" 条记录 ",3)]),s("div",X,o(i.description),1)]))),128))])])])):l.step===4?(n(),a("div",Y,[s("div",Z,[t[11]||(t[11]=s("strong",null,"数据汇总:",-1)),s("div",$,[s("div",ss,[t[9]||(t[9]=s("i",{class:"fas fa-database"},null,-1)),s("span",null,o(l.result.totalSources)+" 个数据源",1)]),s("div",ts,[t[10]||(t[10]=s("i",{class:"fas fa-list"},null,-1)),s("span",null,o(l.result.totalRecords)+" 条记录",1)])])])])):l.step===5?(n(),a("div",es,[s("div",ls,[t[13]||(t[13]=s("strong",null,"调用工具:",-1)),l.result.length>0?(n(),a("div",as,[(n(!0),a(c,null,m(l.result,i=>(n(),a("div",{key:i.type,class:"tool-item"},[s("i",{class:d(r.getToolIcon(i.type))},null,2),s("span",null,o(r.getToolName(i.type)),1)]))),128))])):(n(),a("div",ns,t[12]||(t[12]=[s("i",{class:"fas fa-info-circle"},null,-1),s("span",null,"无需调用额外工具",-1)])))])])):l.step===6?(n(),a("div",os,[s("div",rs,[t[14]||(t[14]=s("strong",null,"AI分析:",-1)),s("div",is,o(r.getAnalysisPreview(l.result)),1)])])):l.step===7?(n(),a("div",us,[s("div",ds,[t[15]||(t[15]=s("strong",null,"数据质量:",-1)),s("span",{class:d(["data-quality","quality-"+l.result.metadata.dataQuality])},o(r.getDataQualityText(l.result.metadata.dataQuality)),3)])])):l.step===8?(n(),a("div",cs,[s("div",ms,[t[18]||(t[18]=s("strong",null,"处理完成:",-1)),s("div",fs,[s("div",_s,[t[16]||(t[16]=s("i",{class:"fas fa-clock"},null,-1)),s("span",null,"总耗时: "+o(l.result.metadata.totalTime)+"ms",1)]),s("div",gs,[t[17]||(t[17]=s("i",{class:"fas fa-check-circle"},null,-1)),s("span",null,"置信度: "+o((l.result.metadata.confidence*100).toFixed(1))+"%",1)])])])])):f("",!0)])):l.status==="processing"?(n(),a("div",vs,t[19]||(t[19]=[s("div",{class:"loading-spinner"},null,-1),s("span",null,"正在处理...",-1)]))):l.status==="failed"?(n(),a("div",ys,t[20]||(t[20]=[s("i",{class:"fas fa-exclamation-triangle"},null,-1),s("span",null,"处理失败",-1)]))):f("",!0)],2))),128))]),u.workflow.status==="completed"?(n(),a("div",ps,[t[24]||(t[24]=s("div",{class:"summary-header"},[s("h4",null,"📊 处理摘要")],-1)),s("div",hs,[s("div",ks,[t[21]||(t[21]=s("strong",null,"总处理时间:",-1)),_(" "+o(u.workflow.totalTime)+"ms ",1)]),t[23]||(t[23]=s("div",{class:"summary-item"},[s("strong",null,"处理状态:"),s("span",{class:"status-success"},"✅ 成功完成")],-1)),s("div",ws,[t[22]||(t[22]=s("strong",null,"数据来源:",-1)),_(" "+o(r.getDataSourceSummary()),1)])])])):f("",!0)])):(n(),a("div",xs,t[25]||(t[25]=[s("i",{class:"fas fa-robot"},null,-1),s("p",null,"等待AI分析...",-1),s("small",null,"发送问题后，这里将显示详细的分析过程",-1)])))])}const Ps=v(p,[["render",Ss],["__scopeId","data-v-0c9ce244"]]);export{Ps as A};
